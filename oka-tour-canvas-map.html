<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–û–∫–∞-–¢—É—Ä 2024: –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞ –º–∞—Ä—à—Ä—É—Ç–∞</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Chart.js - –ø–æ–ø—ã—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö CDN -->
    <script>
        // –ü—Ä–æ–±—É–µ–º –∑–∞–≥—Ä—É–∑–∏—Ç—å Chart.js —Å —Ä–∞–∑–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
        function loadChartJS() {
            const sources = [
                'https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.umd.js',
                'https://unpkg.com/chart.js@4.4.0/dist/chart.umd.js',
                'https://cdn.jsdelivr.net/npm/chart.js@4/dist/chart.umd.js'
            ];
            
            let currentIndex = 0;
            
            function tryNextSource() {
                if (currentIndex >= sources.length) {
                    console.log('Chart.js –Ω–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å, –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω canvas –≥—Ä–∞—Ñ–∏–∫');
                    return;
                }
                
                const script = document.createElement('script');
                script.src = sources[currentIndex];
                script.onload = () => console.log('Chart.js –∑–∞–≥—Ä—É–∂–µ–Ω —É—Å–ø–µ—à–Ω–æ');
                script.onerror = () => {
                    console.log(`–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å Chart.js —Å ${sources[currentIndex]}`);
                    currentIndex++;
                    tryNextSource();
                };
                document.head.appendChild(script);
            }
            
            tryNextSource();
        }
        
        loadChartJS();
    </script>
    
    <style>
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #0a0a0a;
            color: #e2e8f0;
        }
        
        .gradient-text {
            background: linear-gradient(90deg, #38bdf8, #818cf8, #c084fc);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .glassmorphism-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 1rem;
            padding: 1.5rem;
        }
        
        .stat-counter {
            font-size: 2.5rem;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        #mapCanvas {
            border-radius: 1rem;
            background: #1e293b;
            cursor: move;
            width: 100%;
            height: auto;
        }
        
        .point-marker {
            background: linear-gradient(135deg, #38bdf8, #c084fc);
            border: 3px solid white;
            border-radius: 50%;
            width: 32px;
            height: 32px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 14px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
    </style>
</head>
<body class="antialiased">
    <div class="container mx-auto px-4 py-8">
        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
        <div class="text-center mb-8">
            <h1 class="text-4xl md:text-6xl font-bold mb-4">
                <span class="gradient-text">–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞ –º–∞—Ä—à—Ä—É—Ç–∞</span>
            </h1>
            <p class="text-xl text-slate-400">42 –∫–º –≤–µ–ª–æ—Å–∏–ø–µ–¥–Ω–æ–≥–æ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è –≤–¥–æ–ª—å –±–µ—Ä–µ–≥–æ–≤ –û–∫–∏</p>
        </div>
        
        <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –º–∞—Ä—à—Ä—É—Ç–∞ -->
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
            <div class="glassmorphism-card text-center">
                <div class="text-slate-400 text-sm mb-2">–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ</div>
                <div id="distance-stat" class="stat-counter gradient-text">0</div>
                <div class="text-slate-400 text-xs">–∫–º</div>
            </div>
            <div class="glassmorphism-card text-center">
                <div class="text-slate-400 text-sm mb-2">–û–±—â–∏–π –ø–æ–¥—ä—ë–º</div>
                <div id="elevation-gain-stat" class="stat-counter gradient-text">0</div>
                <div class="text-slate-400 text-xs">–º</div>
            </div>
            <div class="glassmorphism-card text-center">
                <div class="text-slate-400 text-sm mb-2">–ú–∞–∫—Å. –≤—ã—Å–æ—Ç–∞</div>
                <div id="max-elevation-stat" class="stat-counter gradient-text">0</div>
                <div class="text-slate-400 text-xs">–º</div>
            </div>
            <div class="glassmorphism-card text-center">
                <div class="text-slate-400 text-sm mb-2">–í—Ä–µ–º—è –≤ –ø—É—Ç–∏</div>
                <div id="time-stat" class="stat-counter gradient-text">2:50</div>
                <div class="text-slate-400 text-xs">—á–∞—Å–æ–≤</div>
            </div>
        </div>
        
        <!-- Canvas –∫–∞—Ä—Ç–∞ -->
        <div class="glassmorphism-card mb-8">
            <div class="relative">
                <canvas id="mapCanvas" width="800" height="600"></canvas>
            </div>
            <div class="mt-4 flex flex-wrap gap-2">
                <button id="zoom-in" class="px-4 py-2 bg-sky-500 text-white rounded-lg hover:bg-sky-600 transition-colors">
                    <span>‚ûï</span> –£–≤–µ–ª–∏—á–∏—Ç—å
                </button>
                <button id="zoom-out" class="px-4 py-2 bg-sky-500 text-white rounded-lg hover:bg-sky-600 transition-colors">
                    <span>‚ûñ</span> –£–º–µ–Ω—å—à–∏—Ç—å
                </button>
                <button id="center-map" class="px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors">
                    <span>üéØ</span> –ü–æ —Ü–µ–Ω—Ç—Ä—É
                </button>
                <button id="toggle-style" class="px-4 py-2 bg-indigo-500 text-white rounded-lg hover:bg-indigo-600 transition-colors">
                    <span>üåô</span> –¢—ë–º–Ω–∞—è
                </button>
                <button id="animate-route" class="px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 transition-colors">
                    <span>‚ñ∂</span> –ê–Ω–∏–º–∞—Ü–∏—è
                </button>
                <button id="download-map" class="px-4 py-2 bg-pink-500 text-white rounded-lg hover:bg-pink-600 transition-colors">
                    <span>üíæ</span> –°–∫–∞—á–∞—Ç—å
                </button>
            </div>
            <p class="mt-3 text-sm text-slate-400 text-center">
                üí° –ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–π—Ç–µ –∫–∞—Ä—Ç—É –º—ã—à—å—é –∏–ª–∏ –ø–∞–ª—å—Ü–µ–º. –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–π—Ç–µ –∫–æ–ª–µ—Å–∏–∫–æ–º –º—ã—à–∏ –∏–ª–∏ –ø–∏–Ω—á–µ–º –Ω–∞ —Å–µ–Ω—Å–æ—Ä–Ω—ã—Ö —ç–∫—Ä–∞–Ω–∞—Ö.
            </p>
        </div>
        
        <!-- –ì—Ä–∞—Ñ–∏–∫ –≤—ã—Å–æ—Ç -->
        <div class="glassmorphism-card mb-8">
            <h2 class="text-2xl font-bold mb-4">–ü—Ä–æ—Ñ–∏–ª—å –≤—ã—Å–æ—Ç</h2>
            <div style="height: 200px; position: relative;">
                <canvas id="elevationChart"></canvas>
            </div>
        </div>
        
        <!-- –ö–ª—é—á–µ–≤—ã–µ —Ç–æ—á–∫–∏ –º–∞—Ä—à—Ä—É—Ç–∞ -->
        <div class="glassmorphism-card">
            <h2 class="text-2xl font-bold mb-4">–ö–ª—é—á–µ–≤—ã–µ —Ç–æ—á–∫–∏ –º–∞—Ä—à—Ä—É—Ç–∞</h2>
            <div id="waypoints-list" class="space-y-2"></div>
        </div>
    </div>
    
    <script>
        // –†–µ–∞–ª—å–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∏–∑ GPX (—Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞ –¥–ª—è –±–æ–ª–µ–µ —Ç–æ—á–Ω–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç–∞)
        const routeCoords = [
            {lat: 54.9651841, lon: 37.5829032, ele: 172},
            {lat: 54.9653065, lon: 37.5828525, ele: 171.5},
            {lat: 54.9650201, lon: 37.5811225, ele: 171},
            {lat: 54.9648123, lon: 37.5798646, ele: 171.5},
            {lat: 54.9642626, lon: 37.5761336, ele: 171.5},
            {lat: 54.9642626, lon: 37.5748032, ele: 172.5},
            {lat: 54.9634957, lon: 37.5714827, ele: 172.2},
            {lat: 54.9601556, lon: 37.5639725, ele: 170},
            {lat: 54.9590961, lon: 37.5660646, ele: 176.6},
            {lat: 54.9573004, lon: 37.5659949, ele: 175.8},
            {lat: 54.9551935, lon: 37.5626367, ele: 171.2},
            {lat: 54.9536287, lon: 37.5652438, ele: 172},
            {lat: 54.9517819, lon: 37.567049, ele: 178},
            {lat: 54.9495962, lon: 37.5508967, ele: 176},
            {lat: 54.9450102, lon: 37.5514814, ele: 180},
            {lat: 54.9435559, lon: 37.5516665, ele: 179.3},
            {lat: 54.9325035, lon: 37.5530773, ele: 174},
            {lat: 54.9234211, lon: 37.5541905, ele: 173},
            {lat: 54.9198696, lon: 37.5565857, ele: 167},
            {lat: 54.9185192, lon: 37.5574386, ele: 170},
            {lat: 54.9138374, lon: 37.5655594, ele: 168.8}, // –î–∞–Ω–∫–∏
            {lat: 54.911984, lon: 37.5600269, ele: 161},
            {lat: 54.9110003, lon: 37.5598955, ele: 153},
            {lat: 54.9091361, lon: 37.5554001, ele: 143.5},
            {lat: 54.9089927, lon: 37.5526938, ele: 155},
            {lat: 54.9097868, lon: 37.5485739, ele: 161.8},
            {lat: 54.9091824, lon: 37.545433, ele: 165.2},
            {lat: 54.9074739, lon: 37.5426784, ele: 168.2},
            {lat: 54.9058547, lon: 37.5398567, ele: 167},
            {lat: 54.9054871, lon: 37.5345535, ele: 167.9},
            {lat: 54.894684, lon: 37.528739, ele: 135.8},
            {lat: 54.8925769, lon: 37.525818, ele: 128.2},
            {lat: 54.8857922, lon: 37.527532, ele: 140.8},
            {lat: 54.8843588, lon: 37.5202417, ele: 132.2},
            {lat: 54.8839392, lon: 37.5166878, ele: 131.8},
            {lat: 54.8802854, lon: 37.5156847, ele: 129.8},
            {lat: 54.8774801, lon: 37.5143597, ele: 124.5},
            {lat: 54.8747687, lon: 37.510559, ele: 112.3},
            {lat: 54.8723874, lon: 37.5070372, ele: 115},
            {lat: 54.8674545, lon: 37.501873, ele: 119}, // –ú-2
            {lat: 54.8625813, lon: 37.4952704, ele: 117},
            {lat: 54.8593023, lon: 37.4869341, ele: 116},
            {lat: 54.856704, lon: 37.4815187, ele: 128.5},
            {lat: 54.8532392, lon: 37.4868375, ele: 123.8},
            {lat: 54.8507069, lon: 37.4915448, ele: 123.2},
            {lat: 54.8476678, lon: 37.4999347, ele: 119.2},
            {lat: 54.8458656, lon: 37.5045642, ele: 122.2},
            {lat: 54.8447552, lon: 37.5092179, ele: 125.2},
            {lat: 54.843647, lon: 37.5099144, ele: 125.2}, // –ö–æ—Å—Ç–∏–Ω–æ
            {lat: 54.8430362, lon: 37.5129354, ele: 125.5},
            {lat: 54.8437189, lon: 37.5185359, ele: 123.1},
            {lat: 54.8446193, lon: 37.5236025, ele: 119.2},
            {lat: 54.8448262, lon: 37.5284681, ele: 118.8},
            {lat: 54.8441158, lon: 37.5335401, ele: 118.2},
            {lat: 54.8431691, lon: 37.5402886, ele: 119.8},
            {lat: 54.8424092, lon: 37.5461143, ele: 123.2},
            {lat: 54.8420215, lon: 37.5519079, ele: 121.8},
            {lat: 54.8419875, lon: 37.5561807, ele: 120},
            {lat: 54.8414516, lon: 37.5594288, ele: 121.8},
            {lat: 54.8409820, lon: 37.5613037, ele: 122.8},
            {lat: 54.8401912, lon: 37.5651339, ele: 121.5},
            {lat: 54.8398607, lon: 37.5664884, ele: 118.8},
            {lat: 54.8395147, lon: 37.5701442, ele: 121.5},
            {lat: 54.839334, lon: 37.5735828, ele: 121},
            {lat: 54.8391455, lon: 37.5774962, ele: 120.8},
            {lat: 54.8389849, lon: 37.5795668, ele: 120.2},
            {lat: 54.8383547, lon: 37.5877395, ele: 117},
            {lat: 54.8380025, lon: 37.5918192, ele: 115.8},
            {lat: 54.8382574, lon: 37.5958693, ele: 142.2},
            {lat: 54.8391266, lon: 37.5967865, ele: 147.5}, // –£—Å–∞–¥—å–±–∞
            {lat: 54.8396225, lon: 37.6033974, ele: 138}, // –í–æ–¥–æ–ø–∞–¥
            {lat: 54.8387084, lon: 37.6027706, ele: 156},
            {lat: 54.8390621, lon: 37.6089102, ele: 160.3},
            {lat: 54.8389602, lon: 37.6107261, ele: 162},
            {lat: 54.8384829, lon: 37.6120296, ele: 166.5},
            {lat: 54.8374109, lon: 37.6129496, ele: 173.2},
            {lat: 54.8360593, lon: 37.6133895, ele: 184},
            {lat: 54.8354707, lon: 37.6190785, ele: 182.5},
            {lat: 54.8350753, lon: 37.6232117, ele: 181},
            {lat: 54.8346149, lon: 37.6281443, ele: 181.5},
            {lat: 54.8330083, lon: 37.6344797, ele: 181.8},
            {lat: 54.8335042, lon: 37.6377225, ele: 177},
            {lat: 54.8350243, lon: 37.6380712, ele: 168},
            {lat: 54.8373661, lon: 37.637921, ele: 148},
            {lat: 54.8385400, lon: 37.6406354, ele: 137.2},
            {lat: 54.8396614, lon: 37.64166, ele: 132.5},
            {lat: 54.8437498, lon: 37.6408044, ele: 116.5},
            {lat: 54.8480755, lon: 37.6402733, ele: 114.5},
            {lat: 54.8487473, lon: 37.6404686, ele: 110.9}, // –ü–ª—è–∂
            // –û–±—Ä–∞—Ç–Ω—ã–π –ø—É—Ç—å (—Å–æ–∫—Ä–∞—â–µ–Ω–Ω–æ)
            {lat: 54.8480755, lon: 37.6402733, ele: 114.5},
            {lat: 54.8437498, lon: 37.6408044, ele: 116.5},
            {lat: 54.8396414, lon: 37.6016173, ele: 131},
            {lat: 54.8420215, lon: 37.5519079, ele: 121.8},
            {lat: 54.843647, lon: 37.5099144, ele: 125.2},
            {lat: 54.8674545, lon: 37.501873, ele: 119},
            {lat: 54.9054871, lon: 37.5345535, ele: 167.9},
            {lat: 54.9138374, lon: 37.5655594, ele: 168.8},
            {lat: 54.9495962, lon: 37.5508967, ele: 176},
            {lat: 54.9651841, lon: 37.5829032, ele: 172}
        ];
        
        // –ö–ª—é—á–µ–≤—ã–µ —Ç–æ—á–∫–∏
        const keyPoints = [
            {lat: 54.9651841, lon: 37.5829032, name: "–°—Ç–∞—Ä—Ç/–§–∏–Ω–∏—à: –ê—Ä–Ω–µ–µ–≤–æ", desc: "–î–æ–º –ë–æ–≥–¥–∞–Ω–∞"},
            {lat: 54.9138374, lon: 37.5655594, name: "–î–∞–Ω–∫–∏", desc: "–ü–µ—Ä–≤–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞"},
            {lat: 54.8674545, lon: 37.501873, name: "–¢—Ä–∞—Å—Å–∞ –ú-2 –ö—Ä—ã–º", desc: "–ü–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ —Å —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω–æ–π —Ç—Ä–∞—Å—Å–æ–π"},
            {lat: 54.843647, lon: 37.5099144, name: "–ö–æ—Å—Ç–∏–Ω–æ", desc: "–õ–µ—Å–Ω—ã–µ —Ç—Ä–æ–ø—ã –∏ –ø–æ–¥—ä—ë–º—ã"},
            {lat: 54.8391266, lon: 37.5967865, name: "–ü—É—â–∏–Ω—Å–∫–∞—è —É—Å–∞–¥—å–±–∞", desc: "–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–µ –º–µ—Å—Ç–æ"},
            {lat: 54.8396225, lon: 37.6033974, name: "–ü—É—â–∏–Ω—Å–∫–∏–π –≤–æ–¥–æ–ø–∞–¥", desc: "–ü—Ä–∏—Ä–æ–¥–Ω–∞—è –¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å"},
            {lat: 54.8487473, lon: 37.6404686, name: "–ü–ª—è–∂ –ü—É—â–∏–Ω–æ", desc: "–û—Ç–¥—ã—Ö —É –≤–æ–¥—ã"}
        ];
        
        // Canvas setup
        const canvas = document.getElementById('mapCanvas');
        const ctx = canvas.getContext('2d');
        
        // –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
        let zoom = 1;
        let offsetX = 0;
        let offsetY = 0;
        let isDragging = false;
        let startX, startY;
        let mapStyle = 'dark'; // dark, light –∏–ª–∏ terrain
        
        // –†–∞—Å—á–µ—Ç –≥—Ä–∞–Ω–∏—Ü –º–∞—Ä—à—Ä—É—Ç–∞
        const bounds = {
            minLat: Math.min(...routeCoords.map(p => p.lat)),
            maxLat: Math.max(...routeCoords.map(p => p.lat)),
            minLon: Math.min(...routeCoords.map(p => p.lon)),
            maxLon: Math.max(...routeCoords.map(p => p.lon))
        };
        
        const centerLat = (bounds.minLat + bounds.maxLat) / 2;
        const centerLon = (bounds.minLon + bounds.maxLon) / 2;
        
        // –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –≤ –ø–∏–∫—Å–µ–ª–∏
        function latLonToPixel(lat, lon) {
            const padding = 0.05; // 5% –æ—Ç—Å—Ç—É–ø —Å –∫–∞–∂–¥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã
            const x = ((lon - bounds.minLon) / (bounds.maxLon - bounds.minLon)) * canvas.width * (1 - 2 * padding) + canvas.width * padding;
            const y = canvas.height - ((lat - bounds.minLat) / (bounds.maxLat - bounds.minLat)) * canvas.height * (1 - 2 * padding) - canvas.height * padding;
            return {
                x: x * zoom + offsetX,
                y: y * zoom + offsetY
            };
        }
        
        // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –∫–∞—Ä—Ç—ã
        function drawMap() {
            // –û—á–∏—Å—Ç–∫–∞ canvas
            ctx.fillStyle = '#1e293b';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // –°—Ç–∏–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Ñ–æ–Ω –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–µ–º—ã
            if (mapStyle === 'terrain') {
                // –†–µ–ª—å–µ—Ñ–Ω—ã–π —Å—Ç–∏–ª—å
                const gradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
                gradient.addColorStop(0, '#2d5a2d');
                gradient.addColorStop(0.3, '#1e3a1e');
                gradient.addColorStop(0.7, '#0f2f0f');
                gradient.addColorStop(1, '#0a1f0a');
                ctx.fillStyle = gradient;
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                // –ò–º–∏—Ç–∞—Ü–∏—è —Ä–µ–ª—å–µ—Ñ–∞ - –∫–æ–Ω—Ç—É—Ä–Ω—ã–µ –ª–∏–Ω–∏–∏
                ctx.strokeStyle = 'rgba(139, 195, 74, 0.15)';
                ctx.lineWidth = 0.5;
                
                // –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–µ –≤–æ–ª–Ω–∏—Å—Ç—ã–µ –ª–∏–Ω–∏–∏
                for (let i = 0; i < 30; i++) {
                    ctx.beginPath();
                    const baseY = (canvas.height / 30) * i;
                    ctx.moveTo(0, baseY);
                    
                    for (let x = 0; x < canvas.width; x += 5) {
                        const waveY = baseY + Math.sin((x + i * 20) * 0.02) * 10 * Math.cos(i * 0.3);
                        ctx.lineTo(x, waveY);
                    }
                    ctx.stroke();
                }
                
                // –î–æ–±–∞–≤–ª—è–µ–º "—Ö–æ–ª–º—ã" - –∫—Ä—É–≥–æ–≤—ã–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã
                for (let i = 0; i < 5; i++) {
                    const x = Math.random() * canvas.width;
                    const y = Math.random() * canvas.height;
                    const radius = 50 + Math.random() * 100;
                    
                    const hillGradient = ctx.createRadialGradient(x, y, 0, x, y, radius);
                    hillGradient.addColorStop(0, 'rgba(139, 195, 74, 0.1)');
                    hillGradient.addColorStop(1, 'rgba(139, 195, 74, 0)');
                    
                    ctx.fillStyle = hillGradient;
                    ctx.fillRect(x - radius, y - radius, radius * 2, radius * 2);
                }
            } else {
                // –û–±—ã—á–Ω—ã–π —Ñ–æ–Ω
                ctx.fillStyle = mapStyle === 'dark' ? '#1e293b' : '#f1f5f9';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                // –°–µ—Ç–∫–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
                ctx.strokeStyle = mapStyle === 'dark' ? '#334155' : '#e2e8f0';
                ctx.lineWidth = 0.5;
                for (let i = 0; i <= 10; i++) {
                    const x = (canvas.width / 10) * i;
                    const y = (canvas.height / 10) * i;
                    ctx.beginPath();
                    ctx.moveTo(x, 0);
                    ctx.lineTo(x, canvas.height);
                    ctx.moveTo(0, y);
                    ctx.lineTo(canvas.width, y);
                    ctx.stroke();
                }
            }
            
            // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –º–∞—Ä—à—Ä—É—Ç–∞
            ctx.strokeStyle = '#38bdf8';
            ctx.lineWidth = 4 * zoom;
            ctx.lineJoin = 'round';
            ctx.lineCap = 'round';
            ctx.shadowBlur = 10;
            ctx.shadowColor = 'rgba(56, 189, 248, 0.5)';
            ctx.beginPath();
            
            routeCoords.forEach((coord, index) => {
                const point = latLonToPixel(coord.lat, coord.lon);
                if (index === 0) {
                    ctx.moveTo(point.x, point.y);
                } else {
                    ctx.lineTo(point.x, point.y);
                }
            });
        
        // –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –∫–∞—Ä—Ç—ã –∫–∞–∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
        document.getElementById('download-map').addEventListener('click', () => {
            const link = document.createElement('a');
            link.download = 'oka-tour-map.png';
            link.href = canvas.toDataURL();
            link.click();
        });
            ctx.stroke();
            
            // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –æ–±–≤–æ–¥–∫–∞ –¥–ª—è –ª—É—á—à–µ–π –≤–∏–¥–∏–º–æ—Å—Ç–∏
            if (mapStyle === 'terrain') {
                ctx.strokeStyle = 'rgba(255, 255, 255, 0.3)';
                ctx.lineWidth = 6 * zoom;
                ctx.shadowBlur = 0;
                ctx.stroke();
            }
            
            ctx.shadowBlur = 0;
            
            // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –∫–ª—é—á–µ–≤—ã—Ö —Ç–æ—á–µ–∫
            keyPoints.forEach((point, index) => {
                const pixel = latLonToPixel(point.lat, point.lon);
                
                // –¢–µ–Ω—å
                ctx.beginPath();
                ctx.arc(pixel.x, pixel.y + 2, 16 * zoom, 0, Math.PI * 2);
                ctx.fillStyle = 'rgba(0, 0, 0, 0.3)';
                ctx.fill();
                
                // –ì—Ä–∞–¥–∏–µ–Ω—Ç –¥–ª—è —Ç–æ—á–∫–∏
                const gradient = ctx.createRadialGradient(pixel.x, pixel.y, 0, pixel.x, pixel.y, 16 * zoom);
                gradient.addColorStop(0, '#c084fc');
                gradient.addColorStop(1, '#38bdf8');
                
                // –û—Å–Ω–æ–≤–Ω–æ–π –∫—Ä—É–≥
                ctx.beginPath();
                ctx.arc(pixel.x, pixel.y, 16 * zoom, 0, Math.PI * 2);
                ctx.fillStyle = gradient;
                ctx.fill();
                ctx.strokeStyle = 'white';
                ctx.lineWidth = 3 * zoom;
                ctx.stroke();
                
                // –ù–æ–º–µ—Ä —Ç–æ—á–∫–∏
                ctx.fillStyle = 'white';
                ctx.font = `bold ${14 * zoom}px Arial`;
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText(index + 1, pixel.x, pixel.y);
                
                // –ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ—á–∫–∏
                if (zoom > 1.5) {
                    ctx.font = `bold ${12 * zoom}px Arial`;
                    ctx.textAlign = 'center';
                    // –û–±–≤–æ–¥–∫–∞ –¥–ª—è –ª—É—á—à–µ–π —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏
                    ctx.strokeStyle = 'rgba(0, 0, 0, 0.8)';
                    ctx.lineWidth = 4;
                    ctx.strokeText(point.name, pixel.x, pixel.y + 25 * zoom);
                    // –û—Å–Ω–æ–≤–Ω–æ–π —Ç–µ–∫—Å—Ç
                    ctx.fillStyle = 'white';
                    ctx.fillText(point.name, pixel.x, pixel.y + 25 * zoom);
                }
                
                // –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ —Å–ª–µ–¥—É—é—â–µ–π —Ç–æ—á–∫–∏
                if (zoom > 2 && index < keyPoints.length - 1) {
                    const nextPoint = keyPoints[index + 1];
                    const nextPixel = latLonToPixel(nextPoint.lat, nextPoint.lon);
                    
                    // –†–∞—Å—á—ë—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è
                    const lat1 = point.lat * Math.PI / 180;
                    const lat2 = nextPoint.lat * Math.PI / 180;
                    const deltaLat = (nextPoint.lat - point.lat) * Math.PI / 180;
                    const deltaLon = (nextPoint.lon - point.lon) * Math.PI / 180;
                    
                    const a = Math.sin(deltaLat/2) * Math.sin(deltaLat/2) +
                            Math.cos(lat1) * Math.cos(lat2) *
                            Math.sin(deltaLon/2) * Math.sin(deltaLon/2);
                    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
                    const distance = 6371 * c; // –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –≤ –∫–º
                    
                    // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è
                    const midX = (pixel.x + nextPixel.x) / 2;
                    const midY = (pixel.y + nextPixel.y) / 2;
                    
                    ctx.font = `${10 * zoom}px Arial`;
                    ctx.fillStyle = 'rgba(255, 255, 255, 0.8)';
                    ctx.fillText(`${distance.toFixed(1)} –∫–º`, midX, midY);
                }
            });
            
            // –ú–∞—Å—à—Ç–∞–±–Ω–∞—è –ª–∏–Ω–µ–π–∫–∞
            ctx.strokeStyle = 'white';
            ctx.lineWidth = 3;
            ctx.shadowBlur = 4;
            ctx.shadowColor = 'rgba(0, 0, 0, 0.8)';
            ctx.beginPath();
            ctx.moveTo(20, canvas.height - 20);
            ctx.lineTo(120, canvas.height - 20);
            ctx.stroke();
            
            ctx.fillStyle = 'white';
            ctx.font = 'bold 14px Arial';
            ctx.shadowBlur = 4;
            ctx.shadowColor = 'rgba(0, 0, 0, 0.8)';
            ctx.fillText('~5 –∫–º', 125, canvas.height - 16);
            ctx.shadowBlur = 0;
        }
        
        // –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∞ —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π –¥–ª—è canvas
        setTimeout(() => {
            drawMap();
        }, 100);
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
        canvas.addEventListener('mousedown', (e) => {
            isDragging = true;
            startX = e.clientX - offsetX;
            startY = e.clientY - offsetY;
            canvas.style.cursor = 'grabbing';
        });
        
        canvas.addEventListener('mousemove', (e) => {
            if (isDragging) {
                offsetX = e.clientX - startX;
                offsetY = e.clientY - startY;
                drawMap();
            } else {
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–≤–µ–¥–µ–Ω–∏—è –Ω–∞ —Ç–æ—á–∫–∏
                const rect = canvas.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                
                let hovered = false;
                keyPoints.forEach((point, index) => {
                    const pixel = latLonToPixel(point.lat, point.lon);
                    const distance = Math.sqrt(Math.pow(x - pixel.x, 2) + Math.pow(y - pixel.y, 2));
                    
                    if (distance < 20 * zoom) {
                        canvas.style.cursor = 'pointer';
                        canvas.title = `${point.name}\n${point.desc}`;
                        hovered = true;
                    }
                });
                
                if (!hovered) {
                    canvas.style.cursor = 'move';
                    canvas.title = '';
                }
            }
        });
        
        canvas.addEventListener('mouseup', (e) => {
            const wasDragging = isDragging;
            isDragging = false;
            canvas.style.cursor = 'move';
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–∞ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω–µ –±—ã–ª–æ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è
            if (!wasDragging || (Math.abs(e.clientX - startX - offsetX) < 5 && Math.abs(e.clientY - startY - offsetY) < 5)) {
                const rect = canvas.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                
                keyPoints.forEach((point, index) => {
                    const pixel = latLonToPixel(point.lat, point.lon);
                    const distance = Math.sqrt(Math.pow(x - pixel.x, 2) + Math.pow(y - pixel.y, 2));
                    
                    if (distance < 20 * zoom) {
                        // –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –∫–∞—Ä—Ç—É –Ω–∞ —ç—Ç–æ–π —Ç–æ—á–∫–µ
                        offsetX = canvas.width / 2 - pixel.x;
                        offsetY = canvas.height / 2 - pixel.y;
                        zoom = 2;
                        drawMap();
                    }
                });
            }
        });
        
        canvas.addEventListener('wheel', (e) => {
            e.preventDefault();
            const delta = e.deltaY > 0 ? 0.9 : 1.1;
            zoom *= delta;
            zoom = Math.max(0.5, Math.min(5, zoom));
            drawMap();
        });
        
        // –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–µ–Ω—Å–æ—Ä–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
        let touchStartDistance = 0;
        let touchStartZoom = zoom;
        
        canvas.addEventListener('touchstart', (e) => {
            if (e.touches.length === 1) {
                isDragging = true;
                startX = e.touches[0].clientX - offsetX;
                startY = e.touches[0].clientY - offsetY;
            } else if (e.touches.length === 2) {
                // –ù–∞—á–∞–ª–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –ø–∏–Ω—á–µ–º
                const dx = e.touches[0].clientX - e.touches[1].clientX;
                const dy = e.touches[0].clientY - e.touches[1].clientY;
                touchStartDistance = Math.sqrt(dx * dx + dy * dy);
                touchStartZoom = zoom;
            }
        });
        
        canvas.addEventListener('touchmove', (e) => {
            e.preventDefault();
            if (e.touches.length === 1 && isDragging) {
                offsetX = e.touches[0].clientX - startX;
                offsetY = e.touches[0].clientY - startY;
                drawMap();
            } else if (e.touches.length === 2) {
                // –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∏–Ω—á–µ–º
                const dx = e.touches[0].clientX - e.touches[1].clientX;
                const dy = e.touches[0].clientY - e.touches[1].clientY;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                zoom = touchStartZoom * (distance / touchStartDistance);
                zoom = Math.max(0.5, Math.min(5, zoom));
                drawMap();
            }
        });
        
        canvas.addEventListener('touchend', (e) => {
            isDragging = false;
        });
        
        // –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
        document.getElementById('zoom-in').addEventListener('click', () => {
            zoom *= 1.2;
            zoom = Math.min(5, zoom);
            drawMap();
        });
        
        document.getElementById('zoom-out').addEventListener('click', () => {
            zoom *= 0.8;
            zoom = Math.max(0.5, zoom);
            drawMap();
        });
        
        document.getElementById('center-map').addEventListener('click', () => {
            zoom = 1;
            offsetX = 0;
            offsetY = 0;
            drawMap();
        });
        
        document.getElementById('toggle-style').addEventListener('click', function() {
            if (mapStyle === 'dark') {
                mapStyle = 'light';
                this.innerHTML = '<span>‚òÄ</span> –°–≤–µ—Ç–ª–∞—è';
            } else if (mapStyle === 'light') {
                mapStyle = 'terrain';
                this.innerHTML = '<span>üèî</span> –†–µ–ª—å–µ—Ñ';
            } else {
                mapStyle = 'dark';
                this.innerHTML = '<span>üåô</span> –¢—ë–º–Ω–∞—è';
            }
            drawMap();
        });
        
        // –ê–Ω–∏–º–∞—Ü–∏—è –º–∞—Ä—à—Ä—É—Ç–∞
        document.getElementById('animate-route').addEventListener('click', function() {
            let progress = 0;
            let pulseSize = 0;
            const animateStep = () => {
                if (progress <= routeCoords.length) {
                    // –û—á–∏—â–∞–µ–º –∏ –ø–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º —Ñ–æ–Ω
                    ctx.fillStyle = mapStyle === 'dark' ? '#1e293b' : (mapStyle === 'light' ? '#f1f5f9' : '#2d5a2d');
                    ctx.fillRect(0, 0, canvas.width, canvas.height);
                    
                    // –†–∏—Å—É–µ–º —Ç–æ–ª—å–∫–æ —á–∞—Å—Ç—å –º–∞—Ä—à—Ä—É—Ç–∞
                    ctx.strokeStyle = '#38bdf8';
                    ctx.lineWidth = 4 * zoom;
                    ctx.lineJoin = 'round';
                    ctx.lineCap = 'round';
                    ctx.shadowBlur = 10;
                    ctx.shadowColor = 'rgba(56, 189, 248, 0.5)';
                    ctx.beginPath();
                    
                    for (let i = 0; i < progress && i < routeCoords.length; i++) {
                        const point = latLonToPixel(routeCoords[i].lat, routeCoords[i].lon);
                        if (i === 0) {
                            ctx.moveTo(point.x, point.y);
                        } else {
                            ctx.lineTo(point.x, point.y);
                        }
                    }
                    ctx.stroke();
                    ctx.shadowBlur = 0;
                    
                    // –ü—É–ª—å—Å–∏—Ä—É—é—â–∞—è —Ç–æ—á–∫–∞ –Ω–∞ –∫–æ–Ω—Ü–µ –º–∞—Ä—à—Ä—É—Ç–∞
                    if (progress > 0 && progress < routeCoords.length) {
                        const currentPoint = latLonToPixel(
                            routeCoords[Math.min(progress - 1, routeCoords.length - 1)].lat,
                            routeCoords[Math.min(progress - 1, routeCoords.length - 1)].lon
                        );
                        
                        pulseSize = (pulseSize + 0.1) % 2;
                        ctx.beginPath();
                        ctx.arc(currentPoint.x, currentPoint.y, 8 + pulseSize * 4, 0, Math.PI * 2);
                        ctx.fillStyle = 'rgba(56, 189, 248, 0.3)';
                        ctx.fill();
                        
                        ctx.beginPath();
                        ctx.arc(currentPoint.x, currentPoint.y, 6, 0, Math.PI * 2);
                        ctx.fillStyle = '#38bdf8';
                        ctx.fill();
                    }
                    
                    // –û—Ç—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º —Ç–æ—á–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ —É–∂–µ –ø—Ä–æ–π–¥–µ–Ω—ã
                    keyPoints.forEach((point, index) => {
                        const routeIndex = routeCoords.findIndex(c => 
                            Math.abs(c.lat - point.lat) < 0.001 && Math.abs(c.lon - point.lon) < 0.001
                        );
                        
                        if (routeIndex !== -1 && routeIndex < progress) {
                            const pixel = latLonToPixel(point.lat, point.lon);
                            
                            // –¢–µ–Ω—å
                            ctx.beginPath();
                            ctx.arc(pixel.x, pixel.y + 2, 16 * zoom, 0, Math.PI * 2);
                            ctx.fillStyle = 'rgba(0, 0, 0, 0.3)';
                            ctx.fill();
                            
                            // –ì—Ä–∞–¥–∏–µ–Ω—Ç –¥–ª—è —Ç–æ—á–∫–∏
                            const gradient = ctx.createRadialGradient(pixel.x, pixel.y, 0, pixel.x, pixel.y, 16 * zoom);
                            gradient.addColorStop(0, '#c084fc');
                            gradient.addColorStop(1, '#38bdf8');
                            
                            // –û—Å–Ω–æ–≤–Ω–æ–π –∫—Ä—É–≥
                            ctx.beginPath();
                            ctx.arc(pixel.x, pixel.y, 16 * zoom, 0, Math.PI * 2);
                            ctx.fillStyle = gradient;
                            ctx.fill();
                            ctx.strokeStyle = 'white';
                            ctx.lineWidth = 3 * zoom;
                            ctx.stroke();
                            
                            // –ù–æ–º–µ—Ä —Ç–æ—á–∫–∏
                            ctx.fillStyle = 'white';
                            ctx.font = `bold ${14 * zoom}px Arial`;
                            ctx.textAlign = 'center';
                            ctx.textBaseline = 'middle';
                            ctx.fillText(index + 1, pixel.x, pixel.y);
                        }
                    });
                    
                    progress += 3; // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å–∫–æ—Ä–æ—Å—Ç—å –∞–Ω–∏–º–∞—Ü–∏–∏
                    requestAnimationFrame(animateStep);
                } else {
                    drawMap(); // –§–∏–Ω–∞–ª—å–Ω–∞—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∞ —Å–æ –≤—Å–µ–º–∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏
                }
            };
            animateStep();
        });
        
        // –°–ø–∏—Å–æ–∫ —Ç–æ—á–µ–∫
        const waypointsList = document.getElementById('waypoints-list');
        keyPoints.forEach((point, index) => {
            const div = document.createElement('div');
            div.className = 'flex items-center gap-3 p-3 rounded-lg hover:bg-white/5 transition-colors cursor-pointer';
            div.innerHTML = `
                <div class="point-marker">${index + 1}</div>
                <div class="flex-1">
                    <h3 class="font-semibold">${point.name}</h3>
                    <p class="text-sm text-slate-400">${point.desc}</p>
                </div>
            `;
            div.addEventListener('click', () => {
                const pixel = latLonToPixel(point.lat, point.lon);
                offsetX = canvas.width / 2 - pixel.x;
                offsetY = canvas.height / 2 - pixel.y;
                zoom = 2;
                drawMap();
            });
            waypointsList.appendChild(div);
        });
        
        // –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å canvas
        function resizeCanvas() {
            const container = canvas.parentElement;
            const rect = container.getBoundingClientRect();
            canvas.width = rect.width - 48; // padding
            canvas.height = 600;
            drawMap();
        }
        
        window.addEventListener('resize', resizeCanvas);
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –≤—Å–µ—Ö —Ä–µ—Å—É—Ä—Å–æ–≤
        window.addEventListener('load', function() {
            resizeCanvas();
            
            // –ì—Ä–∞—Ñ–∏–∫ –≤—ã—Å–æ—Ç –ø–æ—Å–ª–µ –ø–æ–ª–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏
            setTimeout(() => {
                if (typeof Chart !== 'undefined') {
                    const elevationData = routeCoords.map((coord, index) => ({
                        x: index * (42.3 / routeCoords.length),
                        y: coord.ele
                    }));
                    
                    const ctx2 = document.getElementById('elevationChart').getContext('2d');
                    new Chart(ctx2, {
                        type: 'line',
                        data: {
                            labels: elevationData.map(d => Math.round(d.x) + ' –∫–º'),
                            datasets: [{
                                label: '–í—ã—Å–æ—Ç–∞ (–º)',
                                data: elevationData.map(d => d.y),
                                borderColor: '#38bdf8',
                                backgroundColor: 'rgba(56, 189, 248, 0.1)',
                                fill: true,
                                tension: 0.4
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: { display: false }
                            },
                            scales: {
                                x: {
                                    grid: { color: 'rgba(255, 255, 255, 0.1)' },
                                    ticks: { color: '#94a3b8' }
                                },
                                y: {
                                    grid: { color: 'rgba(255, 255, 255, 0.1)' },
                                    ticks: { color: '#94a3b8' }
                                }
                            }
                        }
                    });
                } else {
                    console.log('–ò—Å–ø–æ–ª—å–∑—É–µ–º Canvas –≥—Ä–∞—Ñ–∏–∫ –≤–º–µ—Å—Ç–æ Chart.js');
                    // –ü—Ä–æ—Å—Ç–æ–π –≥—Ä–∞—Ñ–∏–∫ –Ω–∞ Canvas –±–µ–∑ Chart.js
                    const canvas = document.getElementById('elevationChart');
                    const ctx = canvas.getContext('2d');
                    canvas.width = canvas.offsetWidth;
                    canvas.height = 200;
                    
                    // –û—á–∏—Å—Ç–∫–∞
                    ctx.fillStyle = '#1e293b';
                    ctx.fillRect(0, 0, canvas.width, canvas.height);
                    
                    // –ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Ñ–æ–Ω
                    const bgGradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
                    bgGradient.addColorStop(0, 'rgba(56, 189, 248, 0.1)');
                    bgGradient.addColorStop(1, 'rgba(56, 189, 248, 0)');
                    ctx.fillStyle = bgGradient;
                    ctx.fillRect(0, 0, canvas.width, canvas.height);
                    
                    // –î–∞–Ω–Ω—ã–µ –≤—ã—Å–æ—Ç
                    const elevations = routeCoords.map(c => c.ele);
                    const minEle = Math.min(...elevations);
                    const maxEle = Math.max(...elevations);
                    const range = maxEle - minEle;
                    
                    // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –≥—Ä–∞—Ñ–∏–∫–∞
                    ctx.strokeStyle = '#38bdf8';
                    ctx.lineWidth = 2;
                    ctx.beginPath();
                    
                    elevations.forEach((ele, i) => {
                        const x = (i / elevations.length) * canvas.width;
                        const y = canvas.height - ((ele - minEle) / range) * (canvas.height - 40) - 20;
                        
                        if (i === 0) {
                            ctx.moveTo(x, y);
                        } else {
                            ctx.lineTo(x, y);
                        }
                    });
                    ctx.stroke();
                    
                    // –ó–∞–ª–∏–≤–∫–∞
                    ctx.lineTo(canvas.width, canvas.height - 20);
                    ctx.lineTo(0, canvas.height - 20);
                    ctx.closePath();
                    ctx.fillStyle = 'rgba(56, 189, 248, 0.1)';
                    ctx.fill();
                    
                    // –ü–æ–¥–ø–∏—Å–∏
                    ctx.fillStyle = '#94a3b8';
                    ctx.font = '12px Arial';
                    ctx.fillText(`${Math.round(minEle)}–º`, 5, canvas.height - 5);
                    ctx.fillText(`${Math.round(maxEle)}–º`, 5, 20);
                    ctx.fillText('0 –∫–º', 5, canvas.height - 25);
                    ctx.fillText('42.3 –∫–º', canvas.width - 40, canvas.height - 25);
                    
                    // –°–µ—Ç–∫–∞
                    ctx.strokeStyle = 'rgba(255, 255, 255, 0.1)';
                    ctx.lineWidth = 0.5;
                    for (let i = 1; i < 5; i++) {
                        const y = (canvas.height - 40) * (i / 5) + 20;
                        ctx.beginPath();
                        ctx.moveTo(0, y);
                        ctx.lineTo(canvas.width, y);
                        ctx.stroke();
                        
                        const height = Math.round(maxEle - (range * (i / 5)));
                        ctx.fillText(`${height}–º`, 5, y - 5);
                    }
                }
            }, 1000); // –ó–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ Chart.js
        });
        
        // –ù–∞—á–∞–ª—å–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è canvas
        resizeCanvas();
        
        // –ê–Ω–∏–º–∞—Ü–∏—è —Å—á–µ—Ç—á–∏–∫–æ–≤
        function animateValue(id, start, end, duration) {
            const element = document.getElementById(id);
            const range = end - start;
            const increment = range / (duration / 16);
            let current = start;
            
            const timer = setInterval(() => {
                current += increment;
                if ((increment > 0 && current >= end) || (increment < 0 && current <= end)) {
                    current = end;
                    clearInterval(timer);
                }
                element.textContent = Math.round(current * 10) / 10;
            }, 16);
        }
        
        // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é —Å—á–µ—Ç—á–∏–∫–æ–≤
        setTimeout(() => {
            // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —Ä–µ–∞–ª—å–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–∞—Ä—à—Ä—É—Ç–∞
            let totalDistance = 0;
            let totalElevationGain = 0;
            let maxElevation = 0;
            
            for (let i = 1; i < routeCoords.length; i++) {
                // –†–∞—Å—á—ë—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è
                const lat1 = routeCoords[i-1].lat * Math.PI / 180;
                const lat2 = routeCoords[i].lat * Math.PI / 180;
                const deltaLat = (routeCoords[i].lat - routeCoords[i-1].lat) * Math.PI / 180;
                const deltaLon = (routeCoords[i].lon - routeCoords[i-1].lon) * Math.PI / 180;
                
                const a = Math.sin(deltaLat/2) * Math.sin(deltaLat/2) +
                        Math.cos(lat1) * Math.cos(lat2) *
                        Math.sin(deltaLon/2) * Math.sin(deltaLon/2);
                const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
                const distance = 6371 * c; // –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –≤ –∫–º
                
                totalDistance += distance;
                
                // –†–∞—Å—á—ë—Ç –ø–æ–¥—ä—ë–º–∞
                const elevDiff = routeCoords[i].ele - routeCoords[i-1].ele;
                if (elevDiff > 0) {
                    totalElevationGain += elevDiff;
                }
                
                // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≤—ã—Å–æ—Ç–∞
                if (routeCoords[i].ele > maxElevation) {
                    maxElevation = routeCoords[i].ele;
                }
            }
            
            animateValue('distance-stat', 0, totalDistance, 2000);
            animateValue('elevation-gain-stat', 0, Math.round(totalElevationGain), 2000);
            animateValue('max-elevation-stat', 0, Math.round(maxElevation), 2000);
        }, 500);
    </script>
</body>
</html>