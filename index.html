<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–û–∫–∞-–¢—É—Ä: –í–µ–ª–æ—Å–∏–ø–µ–¥–Ω–æ–µ –ü—Ä–∏–∫–ª—é—á–µ–Ω–∏–µ</title>
    
    <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ Tailwind CSS –¥–ª—è —Å—Ç–∏–ª–∏–∑–∞—Ü–∏–∏ -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —à—Ä–∏—Ñ—Ç–∞ Inter –∏–∑ Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;700;900&family=Montserrat:wght@700&display=swap" rel="stylesheet">

    <!-- –ò–∫–æ–Ω–∫–∏ -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        /* –ö–∞—Å—Ç–æ–º–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è —ç—Å—Ç–µ—Ç–∏–∫–∏ */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0a0a0a;
            color: #e2e8f0;
            overflow-x: hidden;
            /* –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∫—É—Ä—Å–æ—Ä */
            cursor: url('endurance.cur'), auto;
        }

        /* –°—Ç–∏–ª—å –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ */
        .montserrat-heading {
            font-family: 'Montserrat', sans-serif;
        }

        /* –ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Ç–µ–∫—Å—Ç */
        .gradient-text {
            background: linear-gradient(90deg, #38bdf8, #818cf8, #c084fc);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-fill-color: transparent;
        }
        
        /* –ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω–∞—è –∫–Ω–æ–ø–∫–∞ */
        .gemini-button {
             background-image: linear-gradient(to right, #38bdf8 0%, #c084fc 100%);
             transition: all 0.3s ease;
        }
        .gemini-button:hover {
            box-shadow: 0 0 20px #c084fc80;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è 3D —Å—Ü–µ–Ω—ã */
        #three-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            opacity: 0.2;
        }
        
        /* –§–æ–Ω –¥–ª—è Hero —Å–µ–∫—Ü–∏–∏ */
        .hero-bg {
            background-image: url('https://i.imgur.com/V7rdQN4.png');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }

        /* –ö–ª–∞—Å—Å –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏ –ø–æ—è–≤–ª–µ–Ω–∏—è */
        .reveal {
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.8s ease-out, transform 0.8s ease-out;
        }

        .reveal.visible {
            opacity: 1;
            transform: translateY(0);
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫ */
        .glassmorphism-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 1rem;
            transition: all 0.3s ease;
        }

        .glassmorphism-card:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
            background: rgba(255, 255, 255, 0.1);
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .modal-overlay.visible {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: #1e293b; /* –ß—É—Ç—å —Å–≤–µ—Ç–ª–µ–µ —Ñ–æ–Ω */
            border-radius: 1rem;
            padding: 2rem;
            width: 90%;
            max-width: 600px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transform: scale(0.95);
            transition: transform 0.3s ease;
        }
        
        .modal-overlay.visible .modal-content {
            transform: scale(1);
        }

        /* –°–ø–∏–Ω–Ω–µ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ */
        .loader {
            border: 4px solid #f3f3f330;
            border-top: 4px solid #38bdf8;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–π –∫–∞—Ä—Ç—ã */
        #mapCanvas {
            border-radius: 1rem;
            background: #1e293b;
            cursor: move;
            width: 100%;
            height: auto;
        }
        
        .stat-counter {
            font-size: 2.5rem;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .point-marker {
            background: linear-gradient(135deg, #38bdf8, #c084fc);
            border: 3px solid white;
            border-radius: 50%;
            width: 32px;
            height: 32px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 14px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
    </style>
</head>
<body class="antialiased">

    <!-- –ê—É–¥–∏–æ–ø–ª–µ–µ—Ä –¥–ª—è —Ñ–æ–Ω–æ–≤–æ–π –º—É–∑—ã–∫–∏ -->
    <audio id="background-music" loop>
        <source src="https://files.catbox.moe/rpvne7.mp3" type="audio/mpeg">
        –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∞—É–¥–∏–æ—ç–ª–µ–º–µ–Ω—Ç—ã.
    </audio>

    <!-- 3D Canvas –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏ -->
    <div id="three-canvas-container" class="fixed top-0 left-0 w-full h-full z-0">
        <canvas id="three-canvas"></canvas>
    </div>

    <div class="relative z-10">
        <!-- –°–µ–∫—Ü–∏—è Hero: –ó–∞–≥–ª–∞–≤–Ω–∞—è -->
        <header class="h-screen min-h-[700px] flex flex-col items-center justify-center text-center p-4 relative overflow-hidden hero-bg">
            <div class="absolute inset-0 bg-black/70 z-10"></div>
            <div class="relative z-20 flex flex-col items-center">
                <div class="mb-4 reveal">
                    <span class="inline-block bg-sky-500/10 text-sky-400 text-sm font-medium px-4 py-1 rounded-full">
                        12 –ò—é–ª—è, –°—É–±–±–æ—Ç–∞
                    </span>
                </div>
                <h1 class="montserrat-heading text-5xl md:text-7xl lg:text-8xl font-black uppercase tracking-tighter reveal" style="transition-delay: 0.2s;">
                    <span class="gradient-text">–û–∫–∞-–¢—É—Ä</span>
                </h1>
                <p class="mt-6 text-lg md:text-xl max-w-2xl text-slate-300 reveal" style="transition-delay: 0.4s;">
                –≠–ø–∏—á–µ—Å–∫–æ–µ –≤–µ–ª–æ–ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ –≤–¥–æ–ª—å –∂–∏–≤–æ–ø–∏—Å–Ω—ã—Ö –±–µ—Ä–µ–≥–æ–≤ –û–∫–∏ —Å —Ç—Ä–∏—É–º—Ñ–∞–ª—å–Ω—ã–º –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º –Ω–∞ –±–∞–∑—É!
                </p>
                <div class="mt-10 flex flex-col sm:flex-row gap-4">
                    <div class="reveal" style="transition-delay: 0.5s;">
                         <button id="play-music-btn" class="w-full bg-emerald-500 text-white font-bold py-3 px-8 rounded-full text-lg hover:bg-emerald-600 transition-all duration-300 transform hover:scale-105 shadow-lg shadow-emerald-500/20 flex items-center justify-center gap-2">
                             <i data-lucide="play-circle"></i>
                             –í–∫–ª—é—á–∏—Ç—å –ë–ª—é–∑
                         </button>
                    </div>
                    <div class="reveal" style="transition-delay: 0.6s;">
                        <a href="#route" class="w-full bg-sky-500 text-white font-bold py-3 px-8 rounded-full text-lg hover:bg-sky-600 transition-all duration-300 transform hover:scale-105 shadow-lg shadow-sky-500/20 flex items-center justify-center gap-2">
                            <i data-lucide="map"></i>
                            –ù–∞—à –ú–∞—Ä—à—Ä—É—Ç
                        </a>
                    </div>
                </div>
            </div>
            <div class="absolute bottom-10 z-20 animate-bounce">
                <i data-lucide="arrow-down" class="w-8 h-8 text-white/50"></i>
            </div>
        </header>

        <main class="bg-black/80 backdrop-blur-sm">
            <!-- –°–µ–∫—Ü–∏—è: –ö–æ–º–∞–Ω–¥–∞ -->
            <section id="team" class="py-20 sm:py-32">
                <div class="container mx-auto px-4">
                    <div class="text-center mb-16 reveal">
                        <h2 class="text-4xl md:text-5xl font-bold montserrat-heading">–ù–∞—à–∞ <span class="gradient-text">–ö–æ–º–∞–Ω–¥–∞</span></h2>
                        <p class="mt-4 text-lg text-slate-400 max-w-xl mx-auto">–¢—Ä–∏ —Ç–æ–≤–∞—Ä–∏—â–∞, –æ–¥–Ω–∞ —Ü–µ–ª—å: –ø–æ–∫–æ—Ä–∏—Ç—å –≥–æ—Ä–∏–∑–æ–Ω—Ç.</p>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-8 lg:gap-12">
                        <div class="glassmorphism-card p-8 text-center reveal">
                            <img src="https://placehold.co/150x150/0a0a0a/c084fc?text=–Æ" alt="–§–æ—Ç–æ –Æ—Ä—ã" class="w-32 h-32 rounded-full mx-auto mb-6 border-4 border-purple-500/50 shadow-lg">
                            <h3 class="text-2xl font-bold text-white">–Æ—Ä–∞ "–°–∫–æ—Ä–æ—Å—Ç—å"</h3>
                            <p class="mt-2 text-purple-300 font-medium">–ì–ª–∞–≤–Ω—ã–π –ø–æ —Å–∫–æ—Ä–æ—Å—Ç–∏</p>
                            <p class="mt-4 text-slate-400">–ü–µ—Ä–≤—ã–º –ø—Ä–∏–µ–∑–∂–∞–µ—Ç –Ω–∞ –≤—Å–µ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏ —Å —É–¥–∏–≤–ª–µ–Ω–∏–µ–º —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç: "–ê –≥–¥–µ –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ?"</p>
                        </div>
                        <div class="glassmorphism-card p-8 text-center reveal" style="transition-delay: 0.2s;">
                            <img src="https://placehold.co/150x150/0a0a0a/818cf8?text=–°" alt="–§–æ—Ç–æ –°–µ—Ä–≥–µ—è" class="w-32 h-32 rounded-full mx-auto mb-6 border-4 border-indigo-500/50 shadow-lg">
                            <h3 class="text-2xl font-bold text-white">–°–µ—Ä–≥–µ–π "–ü–æ–≤–µ–ª–∏—Ç–µ–ª—å –Ω–∞—Å–æ—Å–∞"</h3>
                            <p class="mt-2 text-indigo-300 font-medium">–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –≥—É—Ä—É</p>
                            <p class="mt-4 text-slate-400">–ó–Ω–∞–µ—Ç –≤—Å—ë –æ –¥–∞–≤–ª–µ–Ω–∏–∏ –≤ —à–∏–Ω–∞—Ö. –¢–∞–∫–∂–µ –∏–∑–≤–µ—Å—Ç–µ–Ω –∫–∞–∫ "—Ç–∞–π–Ω–∞—è –ª–æ—à–∞–¥–∫–∞" –≥—Ä—É–ø–ø—ã.</p>
                        </div>
                        <div class="glassmorphism-card p-8 text-center reveal" style="transition-delay: 0.4s;">
                            <img src="https://placehold.co/150x150/0a0a0a/38bdf8?text=–ë" alt="–§–æ—Ç–æ –ë–æ–≥–¥–∞–Ω–∞" class="w-32 h-32 rounded-full mx-auto mb-6 border-4 border-sky-500/50 shadow-lg">
                            <h3 class="text-2xl font-bold text-white">–ë–æ–≥–¥–∞–Ω "–•–æ–∑—è–∏–Ω –±–∞–∑—ã"</h3>
                            <p class="mt-2 text-sky-300 font-medium">–ì–ª–∞–≤–Ω—ã–π –ø–æ –≥–æ—Å—Ç–µ–ø—Ä–∏–∏–º—Å—Ç–≤—É</p>
                            <p class="mt-4 text-slate-400">–î–µ—Ä–∂–∏—Ç –±–∞–∑—É –≤ –ê—Ä–Ω–µ–µ–≤–æ –∏ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç –¥—Ä—É–∑–µ–π —à–∞—à–ª—ã–∫–∞–º–∏, —Å–∞—É–Ω–æ–π –∏ –ø–∏–≤–æ–º.</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- –°–µ–∫—Ü–∏—è: –ú–∞—Ä—à—Ä—É—Ç -->
            <section id="route" class="py-20 sm:py-32 bg-slate-900/50">
                <div class="container mx-auto px-4">
                    <div class="text-center mb-16 reveal">
                        <h2 class="text-4xl md:text-5xl font-bold montserrat-heading">–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞ <span class="gradient-text">–ú–∞—Ä—à—Ä—É—Ç–∞</span></h2>
                        <p class="mt-4 text-lg text-slate-400 max-w-xl mx-auto">42 –∫–º –≤–µ–ª–æ—Å–∏–ø–µ–¥–Ω–æ–≥–æ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è –≤–¥–æ–ª—å –±–µ—Ä–µ–≥–æ–≤ –û–∫–∏. –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–π—Ç–µ —Å –∫–∞—Ä—Ç–æ–π!</p>
                    </div>
                    
                    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –º–∞—Ä—à—Ä—É—Ç–∞ -->
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8 reveal">
                        <div class="glassmorphism-card text-center p-4">
                            <div class="text-slate-400 text-sm mb-2">–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ</div>
                            <div id="distance-stat" class="stat-counter gradient-text">0</div>
                            <div class="text-slate-400 text-xs">–∫–º</div>
                        </div>
                        <div class="glassmorphism-card text-center p-4">
                            <div class="text-slate-400 text-sm mb-2">–û–±—â–∏–π –ø–æ–¥—ä—ë–º</div>
                            <div id="elevation-gain-stat" class="stat-counter gradient-text">0</div>
                            <div class="text-slate-400 text-xs">–º</div>
                        </div>
                        <div class="glassmorphism-card text-center p-4">
                            <div class="text-slate-400 text-sm mb-2">–ú–∞–∫—Å. –≤—ã—Å–æ—Ç–∞</div>
                            <div id="max-elevation-stat" class="stat-counter gradient-text">0</div>
                            <div class="text-slate-400 text-xs">–º</div>
                        </div>
                        <div class="glassmorphism-card text-center p-4">
                            <div class="text-slate-400 text-sm mb-2">–í—Ä–µ–º—è –≤ –ø—É—Ç–∏</div>
                            <div id="time-stat" class="stat-counter gradient-text">2:50</div>
                            <div class="text-slate-400 text-xs">—á–∞—Å–æ–≤</div>
                        </div>
                    </div>
                    
                    <!-- Canvas –∫–∞—Ä—Ç–∞ -->
                    <div class="glassmorphism-card p-6 mb-8 reveal">
                        <div class="relative">
                            <canvas id="mapCanvas" width="800" height="600"></canvas>
                        </div>
                        <div class="mt-4 flex flex-wrap gap-2 justify-center">
                            <button id="zoom-in" class="px-4 py-2 bg-sky-500 text-white rounded-lg hover:bg-sky-600 transition-colors flex items-center gap-2">
                                <span>‚ûï</span> –£–≤–µ–ª–∏—á–∏—Ç—å
                            </button>
                            <button id="zoom-out" class="px-4 py-2 bg-sky-500 text-white rounded-lg hover:bg-sky-600 transition-colors flex items-center gap-2">
                                <span>‚ûñ</span> –£–º–µ–Ω—å—à–∏—Ç—å
                            </button>
                            <button id="center-map" class="px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors flex items-center gap-2">
                                <span>üéØ</span> –ü–æ —Ü–µ–Ω—Ç—Ä—É
                            </button>
                            <button id="toggle-style" class="px-4 py-2 bg-indigo-500 text-white rounded-lg hover:bg-indigo-600 transition-colors flex items-center gap-2">
                                <span>üåô</span> –¢—ë–º–Ω–∞—è
                            </button>
                            <button id="toggle-satellite" class="px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-colors flex items-center gap-2">
                                <span>üõ∞Ô∏è</span> –°–ø—É—Ç–Ω–∏–∫
                            </button>
                            <select id="satellite-provider" class="px-3 py-2 bg-gray-700 text-white rounded-lg border border-gray-600 focus:border-orange-500 transition-colors">
                                <option value="satellite">Google –°–ø—É—Ç–Ω–∏–∫</option>
                                <option value="hybrid">Google –ì–∏–±—Ä–∏–¥</option>
                                <option value="eox">EOX –°–ø—É—Ç–Ω–∏–∫</option>
                                <option value="maxar">Maxar (30—Å–º)</option>
                                <option value="sentinel">Sentinel-2 (10–º)</option>
                            </select>
                            <button id="animate-route" class="px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 transition-colors flex items-center gap-2">
                                <span>‚ñ∂</span> –ê–Ω–∏–º–∞—Ü–∏—è
                            </button>
                            <button id="download-map" class="px-4 py-2 bg-pink-500 text-white rounded-lg hover:bg-pink-600 transition-colors flex items-center gap-2">
                                <span>üíæ</span> –°–∫–∞—á–∞—Ç—å
                            </button>
                        </div>
                        <p class="mt-3 text-sm text-slate-400 text-center">
                            üí° –ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–π—Ç–µ –∫–∞—Ä—Ç—É –º—ã—à—å—é –∏–ª–∏ –ø–∞–ª—å—Ü–µ–º. –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–π—Ç–µ –∫–æ–ª–µ—Å–∏–∫–æ–º –º—ã—à–∏ –∏–ª–∏ –ø–∏–Ω—á–µ–º –Ω–∞ —Å–µ–Ω—Å–æ—Ä–Ω—ã—Ö —ç–∫—Ä–∞–Ω–∞—Ö.<br>
                            üéØ –ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –ø—Ä–æ–Ω—É–º–µ—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–æ—á–∫–∏ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –º–µ—Å—Ç–∞—Ö.
                        </p>
                    </div>
                    
                    <!-- –ì—Ä–∞—Ñ–∏–∫ –≤—ã—Å–æ—Ç -->
                    <div class="glassmorphism-card p-6 mb-8 reveal">
                        <h3 class="text-2xl font-bold mb-4 gradient-text">–ü—Ä–æ—Ñ–∏–ª—å –≤—ã—Å–æ—Ç</h3>
                        <div style="height: 200px; position: relative;">
                            <canvas id="elevationChart"></canvas>
                        </div>
                    </div>
                    
                    <!-- –ö–ª—é—á–µ–≤—ã–µ —Ç–æ—á–∫–∏ –º–∞—Ä—à—Ä—É—Ç–∞ -->
                    <div class="glassmorphism-card p-6 reveal">
                        <h3 class="text-2xl font-bold mb-4 gradient-text">–ö–ª—é—á–µ–≤—ã–µ —Ç–æ—á–∫–∏ –º–∞—Ä—à—Ä—É—Ç–∞</h3>
                        <div id="waypoints-list" class="space-y-2"></div>
                    </div>
                </div>
            </section>

            <!-- –†–ê–ó–î–ï–õ: –ö–ª—é—á–µ–≤—ã–µ —Ç–æ—á–∫–∏ -->
            <section id="pois" class="py-20 sm:py-32">
                <div class="container mx-auto px-4">
                    <div class="text-center mb-16 reveal">
                        <h2 class="text-4xl md:text-5xl font-bold montserrat-heading">–ö–ª—é—á–µ–≤—ã–µ <span class="gradient-text">–¢–æ—á–∫–∏</span></h2>
                        <p class="mt-4 text-lg text-slate-400 max-w-xl mx-auto">–ú–µ—Å—Ç–∞, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–ª—å–∑—è –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å.</p>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                        <div class="reveal group relative overflow-hidden rounded-2xl">
                            <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/91/Pushino_Oka_Manor.jpg/500px-Pushino_Oka_Manor.jpg" alt="–£—Å–∞–¥—å–±–∞ –ü—É—â–∏–Ω–æ" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110">
                            <div class="absolute inset-0 bg-gradient-to-t from-black/80 to-transparent"></div>
                            <div class="absolute bottom-0 left-0 p-8">
                                <h3 class="text-3xl font-bold text-white">–£—Å–∞–¥—å–±–∞ –ü—É—â–∏–Ω–æ</h3>
                                <p class="text-slate-300 mt-2">–ü—Ä–∏–∫–æ—Å–Ω–æ–≤–µ–Ω–∏–µ –∫ –∏—Å—Ç–æ—Ä–∏–∏ –≤ —Ç–µ–Ω–∏ —Å—Ç–∞—Ä–∏–Ω–Ω–æ–≥–æ –ø–∞—Ä–∫–∞.</p>
                            </div>
                        </div>
                        <div class="reveal group relative overflow-hidden rounded-2xl" style="transition-delay: 0.2s;">
                            <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQA4xIWHuUdjTFyf9n12y8exKwQpSuN_xu0tw&s" alt="–ü—É—â–∏–Ω—Å–∫–∏–π –≤–æ–¥–æ–ø–∞–¥" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110">
                            <div class="absolute inset-0 bg-gradient-to-t from-black/80 to-transparent"></div>
                            <div class="absolute bottom-0 left-0 p-8">
                                <h3 class="text-3xl font-bold text-white">–ü—É—â–∏–Ω—Å–∫–∏–π –≤–æ–¥–æ–ø–∞–¥</h3>
                                <p class="text-slate-300 mt-2">–û–∞–∑–∏—Å –ø—Ä–æ—Ö–ª–∞–¥—ã –∏ –∑–≤—É–∫–æ–≤ –ø–∞–¥–∞—é—â–µ–π –≤–æ–¥—ã.</p>
                            </div>
                        </div>
                        <div class="reveal group relative overflow-hidden rounded-2xl" style="transition-delay: 0.4s;">
                            <img src="https://media.kupo.la/thumbor/unsafe/preset/orig/images/2018/9/11/1536655687-YcGRPwpMMsA.jpg" alt="–°–º–æ—Ç—Ä–æ–≤–∞—è –ø–ª–æ—â–∞–¥–∫–∞" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110">
                            <div class="absolute inset-0 bg-gradient-to-t from-black/80 to-transparent"></div>
                            <div class="absolute bottom-0 left-0 p-8">
                                <h3 class="text-3xl font-bold text-white">–°–º–æ—Ç—Ä–æ–≤–∞—è –ø–ª–æ—â–∞–¥–∫–∞</h3>
                                <p class="text-slate-300 mt-2">–ü–∞–Ω–æ—Ä–∞–º–Ω—ã–π –≤–∏–¥ –Ω–∞ –û–∫—É, –æ—Ç –∫–æ—Ç–æ—Ä–æ–≥–æ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –¥—É—Ö.</p>
                            </div>
                        </div>
                        <div class="reveal group relative overflow-hidden rounded-2xl" style="transition-delay: 0.6s;">
                            <img src="https://dynamic-media-cdn.tripadvisor.com/media/photo-o/11/8d/6c/79/caption.jpg?w=1200&h=1200&s=1" alt="–ü–ª—è–∂ –≤ –ü—É—â–∏–Ω–æ" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110">
                            <div class="absolute inset-0 bg-gradient-to-t from-black/80 to-transparent"></div>
                            <div class="absolute bottom-0 left-0 p-8">
                                <h3 class="text-3xl font-bold text-white">–ü–ª—è–∂ –∏ –ø—Ä–∏—Å—Ç–∞–Ω—å</h3>
                                <p class="text-slate-300 mt-2">–ò–¥–µ–∞–ª—å–Ω–æ–µ –º–µ—Å—Ç–æ –¥–ª—è –æ—Ç–¥—ã—Ö–∞ —É –≤–æ–¥—ã –ø–µ—Ä–µ–¥ –æ–±—Ä–∞—Ç–Ω–æ–π –¥–æ—Ä–æ–≥–æ–π.</p>
                            </div>
                        </div>
                        <div class="reveal group relative overflow-hidden rounded-2xl lg:col-span-2" style="transition-delay: 0.8s;">
                            <img src="https://imgur.com/7Rp4Thb.jpg" alt="–ê—Ñ—Ç–µ–ø–∞—Ç–∏ –≤ –ê—Ä–Ω–µ–µ–≤–æ" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110">
                            <div class="absolute inset-0 bg-gradient-to-t from-black/80 to-transparent"></div>
                            <div class="absolute bottom-0 left-0 p-8">
                                <h3 class="text-3xl font-bold text-white">–î–æ–º –ë–æ–≥–¥–∞–Ω–∞: –ê—Ñ—Ç–µ–ø–∞—Ç–∏</h3>
                                <p class="text-slate-300 mt-2">–ó–∞—Å–ª—É–∂–µ–Ω–Ω—ã–π –æ—Ç–¥—ã—Ö: —à–∞—à–ª—ã–∫–∏, —Å–∞—É–Ω–∞ –∏ –ª–µ–¥—è–Ω–æ–µ –ø–∏–≤–æ!</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- –ù–û–í–´–ô –†–ê–ó–î–ï–õ: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –ø–æ–µ–∑–¥–∫–µ -->
            <section id="preparation" class="py-20 sm:py-32 bg-slate-900/50">
                <div class="container mx-auto px-4 text-center">
                    <div class="mb-16 reveal">
                        <h2 class="text-4xl md:text-5xl font-bold montserrat-heading">–ì–æ—Ç–æ–≤–∏–º—Å—è –∫ <span class="gradient-text">–ü–æ–µ–∑–¥–∫–µ</span></h2>
                        <p class="mt-4 text-lg text-slate-400 max-w-xl mx-auto">–ù–µ —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ –≤–∑—è—Ç—å —Å —Å–æ–±–æ–π? –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–∞—à —É–º–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫ –¥–ª—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏!</p>
                    </div>
                    <div class="reveal">
                        <button id="generate-gear-btn" class="gemini-button text-white font-bold py-3 px-8 rounded-full text-lg transform hover:scale-105 shadow-lg shadow-purple-500/20 flex items-center gap-2 mx-auto">
                            <i data-lucide="list-checks"></i>
                            –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–ø–∏—Å–æ–∫ —Å–Ω–∞—Ä—è–∂–µ–Ω–∏—è
                        </button>
                    </div>
                </div>
            </section>

            <!-- –°–µ–∫—Ü–∏—è: –ì–∞–ª–µ—Ä–µ—è -->
            <section id="gallery" class="py-20 sm:py-32">
                <div class="container mx-auto px-4">
                    <div class="text-center mb-16 reveal">
                        <h2 class="text-4xl md:text-5xl font-bold montserrat-heading">–î—É—Ö <span class="gradient-text">–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è</span></h2>
                        <p class="mt-4 text-lg text-slate-400 max-w-xl mx-auto">–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ —à–µ–¥–µ–≤—Ä—ã —Ä—É—Å—Å–∫–æ–π –∂–∏–≤–æ–ø–∏—Å–∏, –≤–¥–æ—Ö–Ω–æ–≤–ª—è—é—â–∏–µ –Ω–∞ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è –ø–æ —Ä–æ–¥–Ω–æ–π –ø—Ä–∏—Ä–æ–¥–µ.</p>
                    </div>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                        <div class="grid gap-4">
                            <div class="reveal"><img class="h-auto max-w-full rounded-lg transition-transform duration-300 hover:scale-105" src="https://assets.wikiwand.com/_next/image?url=https://upload.wikimedia.org/wikipedia/commons/thumb/f/fa/Vladimirka_without_frame.jpg/1100px-Vladimirka_without_frame.jpg&w=828&q=70"></div>
                            <div class="reveal"><img class="h-auto max-w-full rounded-lg transition-transform duration-300 hover:scale-105" src="https://i.imgur.com/lGoVbuW.png" alt="–£—Ç—Ä–æ –≤ —Å–æ—Å–Ω–æ–≤–æ–º –ª–µ—Å—É - –ò–≤–∞–Ω –®–∏—à–∫–∏–Ω"></div>
                        </div>
                        <div class="grid gap-4">
                            <div class="reveal"><img class="h-auto max-w-full rounded-lg transition-transform duration-300 hover:scale-105" src="https://assets.wikiwand.com/_next/image?url=https://upload.wikimedia.org/wikipedia/commons/thumb/9/95/Levitan_nad_vech_pok28.jpg/1100px-Levitan_nad_vech_pok28.jpg&w=828&q=70" alt="–ù–∞–¥ –≤–µ—á–Ω—ã–º –ø–æ–∫–æ–µ–º"></div>
                            <div class="reveal"><img class="h-auto max-w-full rounded-lg transition-transform duration-300 hover:scale-105" src="https://assets.wikiwand.com/_next/image?url=https://upload.wikimedia.org/wikipedia/commons/thumb/5/57/Levitan_Zolotaya_Osen.jpg/1100px-Levitan_Zolotaya_Osen.jpg&w=828&q=70" alt="–ó–æ–ª–æ—Ç–∞—è –æ—Å–µ–Ω—å. –°–ª–æ–±–æ–¥–∫–∞ - –ò—Å–∞–∞–∫ –õ–µ–≤–∏—Ç–∞–Ω"></div>
                        </div>
                        <div class="grid gap-4">
                            <div class="reveal"><img class="h-auto max-w-full rounded-lg transition-transform duration-300 hover:scale-105" src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/96/Klimt_-_Unterach_at_the_Altersee%2C_1916.jpg/1026px-Klimt_-_Unterach_at_the_Altersee%2C_1916.jpg" alt="–£–Ω—Ç–µ—Ä–∞—Ö –Ω–∞ –ê—Ç—Ç–µ—Ä–∑–µ"></div>
                            <div class="reveal"><img class="h-auto max-w-full rounded-lg transition-transform duration-300 hover:scale-105" src="https://cdn.tretyakov.ru/mytretyakov/25/7891912e16d8f6eefddfd0b9de5408a3/thumb/c9a14671cc45ace3df2b2400830bcbf1_x1.png" alt="–°–æ—Å–Ω–æ–≤—ã–π –±–æ—Ä - –ò–≤–∞–Ω –®–∏—à–∫–∏–Ω"></div>
                        </div>
                        <div class="grid gap-4">
                            <div class="reveal"><img class="h-auto max-w-full rounded-lg transition-transform duration-300 hover:scale-105" src="https://assets.wikiwand.com/_next/image?url=https://upload.wikimedia.org/wikipedia/commons/thumb/c/ce/Moscow_Courtyard_%2528Polenov%252C_1878%2529_-_Google_Art_Project.jpg/1100px-Moscow_Courtyard_%2528Polenov%252C_1878%2529_-_Google_Art_Project.jpg&w=828&q=70" alt="–ú–æ—Å–∫–æ–≤—Å–∫–∏–π –¥–≤–æ—Ä–∏–∫ - –í–∞—Å–∏–ª–∏–π –ü–æ–ª–µ–Ω–æ–≤"></div>
                            <div class="reveal"><img class="h-auto max-w-full rounded-lg transition-transform duration-300 hover:scale-105" src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/9c/Levitan_High_water.jpg/500px-Levitan_High_water.jpg" alt="–í–µ—Å–Ω–∞. –ë–æ–ª—å—à–∞—è –≤–æ–¥–∞ - –ò—Å–∞–∞–∫ –õ–µ–≤–∏—Ç–∞–Ω"></div>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- –§—É—Ç–µ—Ä -->
        <footer class="py-12 bg-black/50">
            <div class="container mx-auto px-4 text-center text-slate-400">
                 <div class="mb-8">
                    <button id="generate-report-btn" class="gemini-button text-white font-bold py-3 px-8 rounded-full text-lg transform hover:scale-105 shadow-lg shadow-purple-500/20 flex items-center gap-2 mx-auto">
                        ‚ú® –°–æ–∑–¥–∞—Ç—å –æ—Ç—á–µ—Ç –æ –ø–æ–µ–∑–¥–∫–µ
                    </button>
                </div>
                <p class="montserrat-heading text-lg font-bold gradient-text">–û–∫–∞-–¢—É—Ä 2025</p>
                <p class="mt-2">–°–æ–∑–¥–∞–Ω–æ —Å –ª—é–±–æ–≤—å—é –∫ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è–º –∏ –∫–æ–¥—É.</p>

                
                <div class="flex justify-center gap-6 mt-6">
                    <a href="#" class="hover:text-white transition-colors"><i data-lucide="instagram"></i></a>
                    <a href="#" class="hover:text-white transition-colors"><i data-lucide="send"></i></a>
                    <a href="#" class="hover:text-white transition-colors"><i data-lucide="youtube"></i></a>
                </div>
            </div>
        </footer>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Ç–æ—á–µ–∫ –º–∞—Ä—à—Ä—É—Ç–∞ -->
    <div id="route-modal" class="modal-overlay">
        <div class="modal-content relative">
            <button id="close-modal" class="absolute top-4 right-4 text-slate-400 hover:text-white transition-colors z-10">
                <i data-lucide="x" class="w-8 h-8"></i>
            </button>
            <img id="modal-img" src="" alt="–§–æ—Ç–æ –ª–æ–∫–∞—Ü–∏–∏" class="w-full h-64 object-cover rounded-lg mb-6">
            <h3 id="modal-title" class="text-3xl font-bold montserrat-heading gradient-text mb-2"></h3>
            <p id="modal-description" class="text-slate-300 mb-6"></p>

            <!-- Gemini Feature: Storyteller -->
            <div id="gemini-story-container">
                <button id="generate-story-btn" class="gemini-button text-white font-bold py-2 px-6 rounded-full text-base flex items-center gap-2 w-full justify-center">
                    ‚ú® –†–∞—Å—Å–∫–∞–∑–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é —ç—Ç–æ–≥–æ –º–µ—Å—Ç–∞
                </button>
                <div id="story-loader" class="hidden loader"></div>
                <div id="story-output" class="mt-4 text-slate-300 bg-slate-800/50 p-4 rounded-lg whitespace-pre-wrap"></div>
            </div>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –æ—Ç—á–µ—Ç–∞ –æ –ø–æ–µ–∑–¥–∫–µ -->
    <div id="report-modal" class="modal-overlay">
        <div class="modal-content relative">
            <button id="close-report-modal" class="absolute top-4 right-4 text-slate-400 hover:text-white transition-colors z-10">
                <i data-lucide="x" class="w-8 h-8"></i>
            </button>
            <h3 class="text-3xl font-bold montserrat-heading gradient-text mb-4">‚ú® –û—Ç—á–µ—Ç –æ –ø–æ–µ–∑–¥–∫–µ</h3>
            <div id="report-loader" class="loader"></div>
            <div id="report-output" class="text-slate-300 bg-slate-800/50 p-4 rounded-lg whitespace-pre-wrap max-h-[60vh] overflow-y-auto"></div>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Å–ø–∏—Å–∫–∞ —Å–Ω–∞—Ä—è–∂–µ–Ω–∏—è -->
    <div id="gear-modal" class="modal-overlay">
        <div class="modal-content relative">
            <button id="close-gear-modal" class="absolute top-4 right-4 text-slate-400 hover:text-white transition-colors z-10">
                <i data-lucide="x" class="w-8 h-8"></i>
            </button>
            <h3 class="text-3xl font-bold montserrat-heading gradient-text mb-4">‚ú® –°–ø–∏—Å–æ–∫ —Å–Ω–∞—Ä—è–∂–µ–Ω–∏—è</h3>
            <div id="gear-loader" class="loader"></div>
            <div id="gear-output" class="text-slate-300 bg-slate-800/50 p-4 rounded-lg whitespace-pre-wrap max-h-[60vh] overflow-y-auto"></div>
        </div>
    </div>


    <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ Three.js –¥–ª—è 3D –≥—Ä–∞—Ñ–∏–∫–∏ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    
    <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫–∞—Ä—Ç—ã -->
    <script src="map.js"></script>
    
    <!-- Chart.js –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤ -->
    <script>
        // –ó–∞–≥—Ä—É–∑–∫–∞ Chart.js —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
        function loadChartJS() {
            const sources = [
                'https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.umd.js',
                'https://unpkg.com/chart.js@4.4.0/dist/chart.umd.js',
                'https://cdn.jsdelivr.net/npm/chart.js@4/dist/chart.umd.js'
            ];
            
            let currentIndex = 0;
            
            function tryNextSource() {
                if (currentIndex >= sources.length) {
                    console.log('Chart.js –Ω–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å, –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω canvas –≥—Ä–∞—Ñ–∏–∫');
                    return;
                }
                
                const script = document.createElement('script');
                script.src = sources[currentIndex];
                script.onload = () => console.log('Chart.js –∑–∞–≥—Ä—É–∂–µ–Ω —É—Å–ø–µ—à–Ω–æ');
                script.onerror = () => {
                    console.log(`–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å Chart.js —Å ${sources[currentIndex]}`);
                    currentIndex++;
                    tryNextSource();
                };
                document.head.appendChild(script);
            }
            
            tryNextSource();
        }
        
        loadChartJS();
    </script>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–∫–æ–Ω–æ–∫
        lucide.createIcons();

        // --- –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø—Ä–∏ —Å–∫—Ä–æ–ª–ª–µ ---
        const revealElements = document.querySelectorAll('.reveal');
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('visible');
                }
            });
        }, {
            threshold: 0.1
        });

        revealElements.forEach(el => {
            observer.observe(el);
        });

        // --- –õ–æ–≥–∏–∫–∞ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω ---
        const routeModal = document.getElementById('route-modal');
        const closeRouteModalBtn = document.getElementById('close-modal');
        const mapPoints = document.querySelectorAll('.map-point');
        
        const reportModal = document.getElementById('report-modal');
        const generateReportBtn = document.getElementById('generate-report-btn');
        const closeReportModalBtn = document.getElementById('close-report-modal');
        
        const gearModal = document.getElementById('gear-modal');
        const generateGearBtn = document.getElementById('generate-gear-btn');
        const closeGearModalBtn = document.getElementById('close-gear-modal');

        const modalTitle = document.getElementById('modal-title');
        const modalDescription = document.getElementById('modal-description');
        const modalImg = document.getElementById('modal-img');
        
        // --- Gemini: –≠–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è –∏—Å—Ç–æ—Ä–∏–∏ ---
        const generateStoryBtn = document.getElementById('generate-story-btn');
        const storyLoader = document.getElementById('story-loader');
        const storyOutput = document.getElementById('story-output');
        let currentLocatonTitle = '';

        mapPoints.forEach(point => {
            point.addEventListener('click', () => {
                currentLocatonTitle = point.dataset.title;
                modalTitle.textContent = currentLocatonTitle;
                modalDescription.textContent = point.dataset.description;
                modalImg.src = point.dataset.img;
                
                // –°–±—Ä–æ—Å —Å–æ—Å—Ç–æ—è–Ω–∏—è Gemini
                storyOutput.innerHTML = '';
                storyOutput.classList.add('hidden');
                generateStoryBtn.classList.remove('hidden');

                routeModal.classList.add('visible');
            });
        });

        const closeRouteModal = () => routeModal.classList.remove('visible');
        closeRouteModalBtn.addEventListener('click', closeRouteModal);
        routeModal.addEventListener('click', (e) => {
            if (e.target === routeModal) closeRouteModal();
        });
        
        const closeReportModal = () => reportModal.classList.remove('visible');
        generateReportBtn.addEventListener('click', () => {
            reportModal.classList.add('visible');
            generateTripReport();
        });
        closeReportModalBtn.addEventListener('click', closeReportModal);
        reportModal.addEventListener('click', (e) => {
            if (e.target === reportModal) closeReportModal();
        });
        
        const closeGearModal = () => gearModal.classList.remove('visible');
        generateGearBtn.addEventListener('click', () => {
            gearModal.classList.add('visible');
            generateGearList();
        });
        if(closeGearModalBtn) {
            closeGearModalBtn.addEventListener('click', closeGearModal);
        }
        gearModal.addEventListener('click', (e) => {
            if (e.target === gearModal) closeGearModal();
        });


        // --- –õ–æ–≥–∏–∫–∞ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –º—É–∑—ã–∫–∏ (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è) ---
        const music = document.getElementById('background-music');
        const playBtn = document.getElementById('play-music-btn');

        playBtn.addEventListener('click', async () => {
            try {
                if (music.paused) {
                    await music.play();
                    playBtn.innerHTML = '<i data-lucide="pause-circle"></i> –í—ã–∫–ª—é—á–∏—Ç—å –ë–ª—é–∑';
                } else {
                    music.pause();
                    playBtn.innerHTML = '<i data-lucide="play-circle"></i> –í–∫–ª—é—á–∏—Ç—å –ë–ª—é–∑';
                }
            } catch (err) {
                console.error('–û—à–∏–±–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –∞—É–¥–∏–æ:', err);
            } finally {
                lucide.createIcons();
            }
        });


        // --- Gemini API ---
        const apiKey = ""; // API-–∫–ª—é—á –±—É–¥–µ—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω —Å—Ä–µ–¥–æ–π –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
        
        /**
         * ‚ú® –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏—Å—Ç–æ—Ä–∏–∏ –æ –º–µ—Å—Ç–µ
         */
        async function generateLocationStory() {
            generateStoryBtn.classList.add('hidden');
            storyLoader.classList.remove('hidden');
            storyOutput.innerHTML = '';
            storyOutput.classList.add('hidden');

            const prompt = `–¢—ã ‚Äî –≤–µ–ª–æ—Å–∏–ø–µ–¥–∏—Å—Ç-–ø—É—Ç–µ—à–µ—Å—Ç–≤–µ–Ω–Ω–∏–∫ —Å –ø–æ—ç—Ç–∏—á–µ—Å–∫–æ–π –¥—É—à–æ–π. –¢—ã —Ç–æ–ª—å–∫–æ —á—Ç–æ –ø—Ä–∏–±—ã–ª –≤ –º–µ—Å—Ç–æ –ø–æ–¥ –Ω–∞–∑–≤–∞–Ω–∏–µ–º "${currentLocatonTitle}" –Ω–∞ –±–µ—Ä–µ–≥—É —Ä–µ–∫–∏ –û–∫–∞. –ù–∞–ø–∏—à–∏ –∫–æ—Ä–æ—Ç–∫–∏–π, —è—Ä–∫–∏–π –∏ —É–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–π —Ö—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Ä–∞—Å—Å–∫–∞–∑ –∏–ª–∏ —Å—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏–µ (–Ω–∞ —Ç–≤–æ–π –≤—ã–±–æ—Ä) –æ–± —ç—Ç–æ–º –º–µ—Å—Ç–µ –∏ —Ç–≤–æ–∏—Ö –æ—â—É—â–µ–Ω–∏—è—Ö. –¢–µ–∫—Å—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ.`;
            
            try {
                const payload = { contents: [{ role: "user", parts: [{ text: prompt }] }] };
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                const result = await response.json();
                
                if (result.candidates && result.candidates[0].content.parts[0].text) {
                    storyOutput.textContent = result.candidates[0].content.parts[0].text;
                } else {
                    storyOutput.textContent = '–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.';
                }
            } catch (error) {
                console.error("Gemini API Error:", error);
                storyOutput.textContent = '–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å.';
            } finally {
                storyLoader.classList.add('hidden');
                storyOutput.classList.remove('hidden');
            }
        }
        
        generateStoryBtn.addEventListener('click', generateLocationStory);

        /**
         * ‚ú® –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç—á–µ—Ç–∞ –æ –ø–æ–µ–∑–¥–∫–µ
         */
        async function generateTripReport() {
            const reportLoader = document.getElementById('report-loader');
            const reportOutput = document.getElementById('report-output');
            
            reportLoader.classList.remove('hidden');
            reportOutput.innerHTML = '';
            
            const prompt = `–ù–∞–ø–∏—à–∏ –∫–æ—Ä–æ—Ç–∫–∏–π, –≤–æ—Å—Ç–æ—Ä–∂–µ–Ω–Ω—ã–π –ø–æ—Å—Ç –¥–ª—è –±–ª–æ–≥–∞ –∏–ª–∏ —Å–æ—Ü–∏–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏ –æ –≤–µ–ª–æ—Å–∏–ø–µ–¥–Ω–æ–π –ø–æ–µ–∑–¥–∫–µ —Ç—Ä–µ—Ö –¥—Ä—É–∑–µ–π (–Æ—Ä–∞ '–°–∫–æ—Ä–æ—Å—Ç—å', –°–µ—Ä–≥–µ–π '–ü–æ–≤–µ–ª–∏—Ç–µ–ª—å –Ω–∞—Å–æ—Å–∞', –∏ –ë–æ–≥–¥–∞–Ω '–•–æ–∑—è–∏–Ω –±–∞–∑—ã') –≤–¥–æ–ª—å —Ä–µ–∫–∏ –û–∫–∞. –ò—Ö –º–∞—Ä—à—Ä—É—Ç –±—ã–ª –∫–æ–ª—å—Ü–µ–≤—ã–º: –æ–Ω–∏ —Å—Ç–∞—Ä—Ç–æ–≤–∞–ª–∏ –æ—Ç –¥–æ–º–∞ –ë–æ–≥–¥–∞–Ω–∞ –≤ –ê—Ä–Ω–µ–µ–≤–æ, –ø–æ—Å–µ—Ç–∏–ª–∏ –ö–æ—Å—Ç–∏–Ω–æ, –£—Å–∞–¥—å–±—É –ü—É—â–∏–Ω–æ, –ü—É—â–∏–Ω—Å–∫–∏–π –≤–æ–¥–æ–ø–∞–¥, —Å–º–æ—Ç—Ä–æ–≤—É—é –ø–ª–æ—â–∞–¥–∫—É, –æ—Ç–¥–æ—Ö–Ω—É–ª–∏ –Ω–∞ –ø–ª—è–∂–µ –≤ –ü—É—â–∏–Ω–æ –∏ —Ç—Ä–∏—É–º—Ñ–∞–ª—å–Ω–æ –≤–µ—Ä–Ω—É–ª–∏—Å—å –æ–±—Ä–∞—Ç–Ω–æ –≤ –ê—Ä–Ω–µ–µ–≤–æ –Ω–∞ –±–∞–∑—É –∫ –ë–æ–≥–¥–∞–Ω—É –Ω–∞ —à–∞—à–ª—ã–∫–∏, –≤ —Å–∞—É–Ω—É –∏ —Å –ø–∏–≤–æ–º. –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –æ–ø–∏—à–∏ —ç–ø–∏—á–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –¥–Ω—è, –∫—Ä–∞—Å–æ—Ç—É –ø—Ä–∏—Ä–æ–¥—ã, –¥—É—Ö —Ç–æ–≤–∞—Ä–∏—â–µ—Å—Ç–≤–∞ –∏ –Ω–µ–∑–∞–±—ã–≤–∞–µ–º—ã–µ –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏—è. –î–æ–±–∞–≤—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö —ç–º–æ–¥–∑–∏ –∏ —Ö—ç—à—Ç–µ–≥–æ–≤. –¢–µ–∫—Å—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ.`;

            try {
                const payload = { contents: [{ role: "user", parts: [{ text: prompt }] }] };
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                const result = await response.json();

                if (result.candidates && result.candidates[0].content.parts[0].text) {
                    reportOutput.textContent = result.candidates[0].content.parts[0].text;
                } else {
                    reportOutput.textContent = '–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –æ—Ç—á–µ—Ç. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.';
                }
            } catch (error) {
                console.error("Gemini API Error:", error);
                reportOutput.textContent = '–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å.';
            } finally {
                reportLoader.classList.add('hidden');
            }
        }
        
        /**
         * ‚ú® –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–ø–∏—Å–∫–∞ —Å–Ω–∞—Ä—è–∂–µ–Ω–∏—è
         */
        async function generateGearList() {
            const gearLoader = document.getElementById('gear-loader');
            const gearOutput = document.getElementById('gear-output');
            
            gearLoader.classList.remove('hidden');
            gearOutput.innerHTML = '';
            
            const prompt = `–¢—ã ‚Äî –æ–ø—ã—Ç–Ω—ã–π –≤–µ–ª–æ—Ç—É—Ä–∏—Å—Ç. –°–æ—Å—Ç–∞–≤—å –ø–æ–¥—Ä–æ–±–Ω—ã–π –∏ —Ö–æ—Ä–æ—à–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Å–Ω–∞—Ä—è–∂–µ–Ω–∏—è –¥–ª—è –æ–¥–Ω–æ–¥–Ω–µ–≤–Ω–æ–π –≤–µ–ª–æ—Å–∏–ø–µ–¥–Ω–æ–π –ø–æ–µ–∑–¥–∫–∏ —Ç—Ä–µ—Ö –¥—Ä—É–∑–µ–π –ø–æ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–Ω–æ–π –º–µ—Å—Ç–Ω–æ—Å—Ç–∏ (–ª–µ—Å–Ω—ã–µ —Ç—Ä–æ–ø—ã, –ø–æ–ª—è, –±–µ—Ä–µ–≥ —Ä–µ–∫–∏). –ü–æ–µ–∑–¥–∫–∞ –≤–∫–ª—é—á–∞–µ—Ç –∫—É–ø–∞–Ω–∏–µ –≤ —Ä–µ–∫–µ –∏ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è –≤–µ—á–µ—Ä–æ–º —Å —à–∞—à–ª—ã–∫–∞–º–∏, —Å–∞—É–Ω–æ–π –∏ –ø–∏–≤–æ–º. –†–∞–∑–¥–µ–ª–∏ —Å–ø–∏—Å–æ–∫ –Ω–∞ —Ç—Ä–∏ —á–µ—Ç–∫–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏: '–õ–∏—á–Ω–æ–µ —Å–Ω–∞—Ä—è–∂–µ–Ω–∏–µ (–¥–ª—è –∫–∞–∂–¥–æ–≥–æ)', '–û–±—â–µ–µ —Å–Ω–∞—Ä—è–∂–µ–Ω–∏–µ (–Ω–∞ –≥—Ä—É–ø–ø—É)' –∏ '–î–ª—è –∞—Ñ—Ç–µ–ø–∞—Ç–∏'. –ò—Å–ø–æ–ª—å–∑—É–π Markdown –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (–∑–∞–≥–æ–ª–æ–≤–∫–∏, —Å–ø–∏—Å–∫–∏). –¢–µ–∫—Å—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ.`;

            try {
                const payload = { contents: [{ role: "user", parts: [{ text: prompt }] }] };
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                const result = await response.json();

                if (result.candidates && result.candidates[0].content.parts[0].text) {
                    // Gemini –º–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å Markdown, –∫–æ—Ç–æ—Ä—ã–π –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å.
                    // –î–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã –ø–æ–∫–∞ –ø—Ä–æ—Å—Ç–æ –≤—Å—Ç–∞–≤–ª—è–µ–º –∫–∞–∫ —Ç–µ–∫—Å—Ç.
                    gearOutput.textContent = result.candidates[0].content.parts[0].text;
                } else {
                    gearOutput.textContent = '–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å —Å–ø–∏—Å–æ–∫. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.';
                }
            } catch (error) {
                console.error("Gemini API Error:", error);
                gearOutput.textContent = '–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å.';
            } finally {
                gearLoader.classList.add('hidden');
            }
        }


        // --- 3D –ê–Ω–∏–º–∞—Ü–∏—è –≤–æ–ª–Ω –Ω–∞ —Ñ–æ–Ω–µ ---
        let scene, camera, renderer, wavePlane;
        let clock = new THREE.Clock();

        function initThree() {
            const container = document.getElementById('three-canvas-container');
            if (!container) return;

            scene = new THREE.Scene();
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.z = 1.5;

            renderer = new THREE.WebGLRenderer({ 
                canvas: document.getElementById('three-canvas'),
                alpha: true
            });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(window.devicePixelRatio);

            const geometry = new THREE.PlaneGeometry(10, 10, 50, 50);
            const material = new THREE.ShaderMaterial({
                uniforms: {
                    u_time: { type: 'f', value: 0.0 },
                    u_colorA: { type: 'v3', value: new THREE.Color('#0a0a0a') },
                    u_colorB: { type: 'v3', value: new THREE.Color('#0f2a4d') }
                },
                vertexShader: `
                    uniform float u_time;
                    varying vec2 vUv;
                    float noise(vec2 st) {
                        return fract(sin(dot(st.xy, vec2(12.9898,78.233))) * 43758.5453123);
                    }
                    void main() {
                        vUv = uv;
                        vec3 pos = position;
                        float noise_freq = 2.5;
                        float noise_amp = 0.15;
                        pos.z += noise(vec2(pos.x*noise_freq + u_time, pos.y*noise_freq)) * noise_amp;
                        pos.z += sin(pos.x * 2.0 + u_time * 1.5) * 0.1;
                        gl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);
                    }
                `,
                fragmentShader: `
                    uniform vec3 u_colorA;
                    uniform vec3 u_colorB;
                    varying vec2 vUv;
                    void main() {
                        gl_FragColor = vec4(mix(u_colorA, u_colorB, vUv.y * 2.0), 1.0);
                    }
                `
            });

            wavePlane = new THREE.Mesh(geometry, material);
            wavePlane.rotation.x = -Math.PI / 2.5;
            wavePlane.position.y = -1;
            scene.add(wavePlane);

            window.addEventListener('resize', onWindowResize, false);
            animate();
        }

        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        function animate() {
            requestAnimationFrame(animate);
            if(wavePlane && wavePlane.material && wavePlane.material.uniforms && wavePlane.material.uniforms.u_time) {
               wavePlane.material.uniforms.u_time.value = clock.getElapsedTime();
            }
            renderer.render(scene, camera);
        }

        initThree();
        
        // ========== –ò–ù–¢–ï–†–ê–ö–¢–ò–í–ù–ê–Ø –ö–ê–†–¢–ê –ú–ê–†–®–†–£–¢–ê ==========
        
        // –î–∞–Ω–Ω—ã–µ –æ –∫–ª—é—á–µ–≤—ã—Ö —Ç–æ—á–∫–∞—Ö —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
        const pointsData = [
            {
                name: "–°—Ç–∞—Ä—Ç/–§–∏–Ω–∏—à: –ê—Ä–Ω–µ–µ–≤–æ",
                desc: "–î–æ–º –ë–æ–≥–¥–∞–Ω–∞",
                img: "https://placehold.co/600x400/1a202c/e2e8f0?text=–î–æ–º+–ë–æ–≥–¥–∞–Ω–∞+–≤+–ê—Ä–Ω–µ–µ–≤–æ",
                details: "–ù–∞—á–∞–ª–æ –∏ –∫–æ–Ω–µ—Ü –Ω–∞—à–µ–≥–æ —ç–ø–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è. –ó–¥–µ—Å—å –Ω–∞—Å –∂–¥—É—Ç —à–∞—à–ª—ã–∫–∏, —Å–∞—É–Ω–∞ –∏ —Ö–æ–ª–æ–¥–Ω–æ–µ –ø–∏–≤–æ!"
            },
            {
                name: "–î–∞–Ω–∫–∏",
                desc: "–ü–µ—Ä–≤–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞",
                img: "https://placehold.co/600x400/1a202c/e2e8f0?text=–î–µ—Ä–µ–≤–Ω—è+–î–∞–Ω–∫–∏",
                details: "–ñ–∏–≤–æ–ø–∏—Å–Ω–∞—è –¥–µ—Ä–µ–≤–µ–Ω—å–∫–∞, –≥–¥–µ –º—ã –¥–µ–ª–∞–µ–º –ø–µ—Ä–≤—ã–π –ø—Ä–∏–≤–∞–ª –∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤–µ–ª–æ—Å–∏–ø–µ–¥–æ–≤."
            },
            {
                name: "–¢—Ä–∞—Å—Å–∞ –ú-2 –ö—Ä—ã–º",
                desc: "–ü–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ —Å —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω–æ–π —Ç—Ä–∞—Å—Å–æ–π",
                img: "https://placehold.co/600x400/1a202c/e2e8f0?text=–¢—Ä–∞—Å—Å–∞+–ú-2",
                details: "–í–∞–∂–Ω—ã–π –æ—Ä–∏–µ–Ω—Ç–∏—Ä –Ω–∞—à–µ–≥–æ –º–∞—Ä—à—Ä—É—Ç–∞ - –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ —Å —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω–æ–π —Ç—Ä–∞—Å—Å–æ–π –ú-2 '–ö—Ä—ã–º'."
            },
            {
                name: "–ö–æ—Å—Ç–∏–Ω–æ",
                desc: "–õ–µ—Å–Ω—ã–µ —Ç—Ä–æ–ø—ã –∏ –ø–æ–¥—ä—ë–º—ã",
                img: "https://placehold.co/600x400/1a202c/e2e8f0?text=–õ–µ—Å—ã+–ö–æ—Å—Ç–∏–Ω–æ",
                details: "–ó–¥–µ—Å—å –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è –Ω–∞—Å—Ç–æ—è—â–∏–µ –ª–µ—Å–Ω—ã–µ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è —Å –∫—Ä–∞—Å–∏–≤—ã–º–∏ —Ç—Ä–æ–ø–∞–º–∏ –∏ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞—é—â–∏–º–∏ –ø–æ–¥—ä—ë–º–∞–º–∏."
            },
            {
                name: "–ü—É—â–∏–Ω—Å–∫–∞—è —É—Å–∞–¥—å–±–∞",
                desc: "–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–µ –º–µ—Å—Ç–æ",
                img: "https://upload.wikimedia.org/wikipedia/commons/thumb/9/91/Pushino_Oka_Manor.jpg/600px-Pushino_Oka_Manor.jpg",
                details: "–°—Ç–∞—Ä–∏–Ω–Ω–∞—è —É—Å–∞–¥—å–±–∞ —Å –±–æ–≥–∞—Ç–æ–π –∏—Å—Ç–æ—Ä–∏–µ–π, –æ–∫—Ä—É–∂—ë–Ω–Ω–∞—è –∂–∏–≤–æ–ø–∏—Å–Ω—ã–º –ø–∞—Ä–∫–æ–º. –ò–¥–µ–∞–ª—å–Ω–æ–µ –º–µ—Å—Ç–æ –¥–ª—è —Ñ–æ—Ç–æ—Å–µ—Å—Å–∏–∏!"
            },
            {
                name: "–ü—É—â–∏–Ω—Å–∫–∏–π –≤–æ–¥–æ–ø–∞–¥",
                desc: "–ü—Ä–∏—Ä–æ–¥–Ω–∞—è –¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å",
                img: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQA4xIWHuUdjTFyf9n12y8exKwQpSuN_xu0tw&s",
                details: "–ü–æ—Ç—Ä—è—Å–∞—é—â–∏–π –≤–æ–¥–æ–ø–∞–¥ —Å—Ä–µ–¥–∏ –ª–µ—Å–∞. –ü—Ä–æ—Ö–ª–∞–¥–Ω–∞—è –≤–æ–¥–∞ –∏ –∑–≤—É–∫–∏ –ø—Ä–∏—Ä–æ–¥—ã - —á—Ç–æ –µ—â—ë –Ω—É–∂–Ω–æ –¥–ª—è –æ—Ç–¥—ã—Ö–∞?"
            },
            {
                name: "–ü–ª—è–∂ –ü—É—â–∏–Ω–æ",
                desc: "–û—Ç–¥—ã—Ö —É –≤–æ–¥—ã",
                img: "https://dynamic-media-cdn.tripadvisor.com/media/photo-o/11/8d/6c/79/caption.jpg?w=600&h=400&s=1",
                details: "–§–∏–Ω–∞–ª—å–Ω–∞—è —Ç–æ—á–∫–∞ –ø–µ—Ä–µ–¥ –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º –¥–æ–º–æ–π. –ö—É–ø–∞–Ω–∏–µ –≤ –û–∫–µ –∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π –æ—Ç–¥—ã—Ö –ø–µ—Ä–µ–¥ –æ–±—Ä–∞—Ç–Ω–æ–π –¥–æ—Ä–æ–≥–æ–π."
            }
        ];
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Ç–æ—á–∫–µ
        function showPointModal(pointData, index) {
            currentLocatonTitle = pointData.name;
            modalTitle.textContent = pointData.name;
            modalDescription.textContent = pointData.details;
            modalImg.src = pointData.img;
            
            // –°–±—Ä–æ—Å —Å–æ—Å—Ç–æ—è–Ω–∏—è Gemini
            storyOutput.innerHTML = '';
            storyOutput.classList.add('hidden');
            generateStoryBtn.classList.remove('hidden');
            
            routeModal.classList.add('visible');
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞—Ä—Ç—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –≤–Ω–µ—à–Ω–µ–≥–æ –º–æ–¥—É–ª—è
        setTimeout(() => {
            if (typeof initInteractiveMap === 'function') {
                const mapApi = initInteractiveMap('mapCanvas', {
                    style: 'dark',
                    height: 600,
                    onPointClick: (point, index) => {
                        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–æ—á–∫–µ –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ
                        showPointModal(pointsData[index], index);
                    }
                });
                
                if (mapApi) {
                    // –ü—Ä–∏–≤—è–∑–∫–∞ –∫–Ω–æ–ø–æ–∫ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫ API –∫–∞—Ä—Ç—ã
                    document.getElementById('zoom-in')?.addEventListener('click', mapApi.zoomIn);
                    document.getElementById('zoom-out')?.addEventListener('click', mapApi.zoomOut);
                    document.getElementById('center-map')?.addEventListener('click', mapApi.center);
                    document.getElementById('animate-route')?.addEventListener('click', mapApi.animateRoute);
                    document.getElementById('download-map')?.addEventListener('click', mapApi.download);
                    
                    // –ö–Ω–æ–ø–∫–∞ —Å–º–µ–Ω—ã —Å—Ç–∏–ª—è
                    document.getElementById('toggle-style')?.addEventListener('click', function() {
                        const currentText = this.innerHTML;
                        if (currentText.includes('üåô')) {
                            mapApi.setStyle('light');
                            this.innerHTML = '<span>‚òÄ</span> –°–≤–µ—Ç–ª–∞—è';
                        } else if (currentText.includes('‚òÄ')) {
                            mapApi.setStyle('terrain');
                            this.innerHTML = '<span>üèî</span> –†–µ–ª—å–µ—Ñ';
                        } else {
                            mapApi.setStyle('dark');
                            this.innerHTML = '<span>üåô</span> –¢—ë–º–Ω–∞—è';
                        }
                    });
                    
                    // –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Å–ø—É—Ç–Ω–∏–∫–æ–≤–æ–≥–æ —Ä–µ–∂–∏–º–∞
                    document.getElementById('toggle-satellite')?.addEventListener('click', function() {
                        mapApi.toggleSatellite();
                        const isEnabled = this.innerHTML.includes('üõ∞Ô∏è');
                        if (isEnabled) {
                            this.innerHTML = '<span>üó∫Ô∏è</span> –û–±—ã—á–Ω–∞—è';
                        } else {
                            this.innerHTML = '<span>üõ∞Ô∏è</span> –°–ø—É—Ç–Ω–∏–∫';
                        }
                    });
                    
                    // –°–µ–ª–µ–∫—Ç–æ—Ä –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ —Å–ø—É—Ç–Ω–∏–∫–æ–≤—ã—Ö —Å–Ω–∏–º–∫–æ–≤
                    document.getElementById('satellite-provider')?.addEventListener('change', function() {
                        mapApi.setSatelliteProvider(this.value);
                        console.log(`–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω –ø—Ä–æ–≤–∞–π–¥–µ—Ä —Å–ø—É—Ç–Ω–∏–∫–æ–≤—ã—Ö —Å–Ω–∏–º–∫–æ–≤ –Ω–∞: ${this.options[this.selectedIndex].text}`);
                    });
                    
                    // –°–æ–∑–¥–∞–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∫–ª—é—á–µ–≤—ã—Ö —Ç–æ—á–µ–∫
                    mapApi.createWaypointsList('waypoints-list');
                    
                    // –ê–Ω–∏–º–∞—Ü–∏—è —Å—á–µ—Ç—á–∏–∫–æ–≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
                    const stats = mapApi.getStats();
                    
                    function animateValue(id, start, end, duration) {
                        const element = document.getElementById(id);
                        if (!element) return;
                        const range = end - start;
                        const increment = range / (duration / 16);
                        let current = start;
                        
                        const timer = setInterval(() => {
                            current += increment;
                            if ((increment > 0 && current >= end) || (increment < 0 && current <= end)) {
                                current = end;
                                clearInterval(timer);
                            }
                            element.textContent = Math.round(current * 10) / 10;
                        }, 16);
                    }
                    
                    animateValue('distance-stat', 0, stats.distance, 2000);
                    animateValue('elevation-gain-stat', 0, stats.elevationGain, 2000);
                    animateValue('max-elevation-stat', 0, stats.maxElevation, 2000);
                    
                    // –ì—Ä–∞—Ñ–∏–∫ –≤—ã—Å–æ—Ç
                    setTimeout(() => {
                        const elevationCanvas = document.getElementById('elevationChart');
                        if (elevationCanvas && typeof Chart !== 'undefined') {
                            const elevationData = routeCoords.map((coord, index) => ({
                                x: index * (42.3 / routeCoords.length),
                                y: coord.ele
                            }));
                            
                            const ctx2 = elevationCanvas.getContext('2d');
                            new Chart(ctx2, {
                                type: 'line',
                                data: {
                                    labels: elevationData.map(d => Math.round(d.x) + ' –∫–º'),
                                    datasets: [{
                                        label: '–í—ã—Å–æ—Ç–∞ (–º)',
                                        data: elevationData.map(d => d.y),
                                        borderColor: '#38bdf8',
                                        backgroundColor: 'rgba(56, 189, 248, 0.1)',
                                        fill: true,
                                        tension: 0.4
                                    }]
                                },
                                options: {
                                    responsive: true,
                                    maintainAspectRatio: false,
                                    plugins: { legend: { display: false } },
                                    scales: {
                                        x: {
                                            grid: { color: 'rgba(255, 255, 255, 0.1)' },
                                            ticks: { color: '#94a3b8' }
                                        },
                                        y: {
                                            grid: { color: 'rgba(255, 255, 255, 0.1)' },
                                            ticks: { color: '#94a3b8' }
                                        }
                                    }
                                }
                            });
                        } else if (elevationCanvas) {
                            // –ü—Ä–æ—Å—Ç–æ–π –≥—Ä–∞—Ñ–∏–∫ –Ω–∞ Canvas –±–µ–∑ Chart.js
                            const ctx = elevationCanvas.getContext('2d');
                            elevationCanvas.width = elevationCanvas.offsetWidth;
                            elevationCanvas.height = 200;
                            
                            const elevations = routeCoords.map(c => c.ele);
                            const minEle = Math.min(...elevations);
                            const maxEle = Math.max(...elevations);
                            const range = maxEle - minEle;
                            
                            ctx.fillStyle = '#1e293b';
                            ctx.fillRect(0, 0, elevationCanvas.width, elevationCanvas.height);
                            
                            ctx.strokeStyle = '#38bdf8';
                            ctx.lineWidth = 2;
                            ctx.beginPath();
                            
                            elevations.forEach((ele, i) => {
                                const x = (i / elevations.length) * elevationCanvas.width;
                                const y = elevationCanvas.height - ((ele - minEle) / range) * (elevationCanvas.height - 40) - 20;
                                
                                if (i === 0) {
                                    ctx.moveTo(x, y);
                                } else {
                                    ctx.lineTo(x, y);
                                }
                            });
                            ctx.stroke();
                            
                            ctx.lineTo(elevationCanvas.width, elevationCanvas.height - 20);
                            ctx.lineTo(0, elevationCanvas.height - 20);
                            ctx.closePath();
                            ctx.fillStyle = 'rgba(56, 189, 248, 0.1)';
                            ctx.fill();
                            
                            ctx.fillStyle = '#94a3b8';
                            ctx.font = '12px Arial';
                            ctx.fillText(`${Math.round(minEle)}–º`, 5, elevationCanvas.height - 5);
                            ctx.fillText(`${Math.round(maxEle)}–º`, 5, 20);
                            ctx.fillText('0 –∫–º', 5, elevationCanvas.height - 25);
                            ctx.fillText('42.3 –∫–º', elevationCanvas.width - 40, elevationCanvas.height - 25);
                        }
                    }, 1000);
                } else {
                    console.error('–ù–µ —É–¥–∞–ª–æ—Å—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∫–∞—Ä—Ç—É');
                }
            } else {
                console.error('–ú–æ–¥—É–ª—å –∫–∞—Ä—Ç—ã –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω');
            }
        }, 200);
    </script>
</body>
</html>
