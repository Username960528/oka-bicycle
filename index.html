<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ока-Тур: Велосипедное Приключение</title>
    
    <!-- Подключение Tailwind CSS для стилизации -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Подключение шрифта Inter из Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;700;900&family=Montserrat:wght@700&display=swap" rel="stylesheet">

    <!-- Иконки -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        /* Кастомные стили для улучшения эстетики */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0a0a0a;
            color: #e2e8f0;
            overflow-x: hidden;
            /* Пользовательский курсор */
            cursor: url('endurance.cur'), auto;
        }

        /* Стиль для заголовков */
        .montserrat-heading {
            font-family: 'Montserrat', sans-serif;
        }

        /* Градиентный текст */
        .gradient-text {
            background: linear-gradient(90deg, #38bdf8, #818cf8, #c084fc);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-fill-color: transparent;
        }
        
        /* Градиентная кнопка */
        .gemini-button {
             background-image: linear-gradient(to right, #38bdf8 0%, #c084fc 100%);
             transition: all 0.3s ease;
        }
        .gemini-button:hover {
            box-shadow: 0 0 20px #c084fc80;
        }

        /* Стили для 3D сцены */
        #three-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            opacity: 0.2;
        }
        
        /* Фон для Hero секции */
        .hero-bg {
            background-image: url('https://i.imgur.com/V7rdQN4.png');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }

        /* Класс для анимации появления */
        .reveal {
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.8s ease-out, transform 0.8s ease-out;
        }

        .reveal.visible {
            opacity: 1;
            transform: translateY(0);
        }
        
        /* Стили для карточек */
        .glassmorphism-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 1rem;
            transition: all 0.3s ease;
        }

        .glassmorphism-card:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
            background: rgba(255, 255, 255, 0.1);
        }

        /* Стили для модальных окон */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .modal-overlay.visible {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: #1e293b; /* Чуть светлее фон */
            border-radius: 1rem;
            padding: 2rem;
            width: 90%;
            max-width: 600px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transform: scale(0.95);
            transition: transform 0.3s ease;
        }
        
        .modal-overlay.visible .modal-content {
            transform: scale(1);
        }

        /* Спиннер загрузки */
        .loader {
            border: 4px solid #f3f3f330;
            border-top: 4px solid #38bdf8;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Стили для интерактивной карты */
        #mapCanvas {
            border-radius: 1rem;
            background: #1e293b;
            cursor: move;
            width: 100%;
            height: auto;
        }
        
        .stat-counter {
            font-size: 2.5rem;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .point-marker {
            background: linear-gradient(135deg, #38bdf8, #c084fc);
            border: 3px solid white;
            border-radius: 50%;
            width: 32px;
            height: 32px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 14px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
    </style>
</head>
<body class="antialiased">

    <!-- Аудиоплеер для фоновой музыки -->
    <audio id="background-music" loop>
        <source src="https://files.catbox.moe/rpvne7.mp3" type="audio/mpeg">
        Ваш браузер не поддерживает аудиоэлементы.
    </audio>

    <!-- 3D Canvas для анимации -->
    <div id="three-canvas-container" class="fixed top-0 left-0 w-full h-full z-0">
        <canvas id="three-canvas"></canvas>
    </div>

    <div class="relative z-10">
        <!-- Секция Hero: Заглавная -->
        <header class="h-screen min-h-[700px] flex flex-col items-center justify-center text-center p-4 relative overflow-hidden hero-bg">
            <div class="absolute inset-0 bg-black/70 z-10"></div>
            <div class="relative z-20 flex flex-col items-center">
                <div class="mb-4 reveal">
                    <span class="inline-block bg-sky-500/10 text-sky-400 text-sm font-medium px-4 py-1 rounded-full">
                        12 Июля, Суббота
                    </span>
                </div>
                <h1 class="montserrat-heading text-5xl md:text-7xl lg:text-8xl font-black uppercase tracking-tighter reveal" style="transition-delay: 0.2s;">
                    <span class="gradient-text">Ока-Тур</span>
                </h1>
                <p class="mt-6 text-lg md:text-xl max-w-2xl text-slate-300 reveal" style="transition-delay: 0.4s;">
                Эпическое велопутешествие вдоль живописных берегов Оки с триумфальным возвращением на базу!
                </p>
                <div class="mt-10 flex flex-col sm:flex-row gap-4">
                    <div class="reveal" style="transition-delay: 0.5s;">
                         <button id="play-music-btn" class="w-full bg-emerald-500 text-white font-bold py-3 px-8 rounded-full text-lg hover:bg-emerald-600 transition-all duration-300 transform hover:scale-105 shadow-lg shadow-emerald-500/20 flex items-center justify-center gap-2">
                             <i data-lucide="play-circle"></i>
                             Включить Блюз
                         </button>
                    </div>
                    <div class="reveal" style="transition-delay: 0.6s;">
                        <a href="#route" class="w-full bg-sky-500 text-white font-bold py-3 px-8 rounded-full text-lg hover:bg-sky-600 transition-all duration-300 transform hover:scale-105 shadow-lg shadow-sky-500/20 flex items-center justify-center gap-2">
                            <i data-lucide="map"></i>
                            Наш Маршрут
                        </a>
                    </div>
                </div>
            </div>
            <div class="absolute bottom-10 z-20 animate-bounce">
                <i data-lucide="arrow-down" class="w-8 h-8 text-white/50"></i>
            </div>
        </header>

        <main class="bg-black/80 backdrop-blur-sm">
            <!-- Секция: Команда -->
            <section id="team" class="py-20 sm:py-32">
                <div class="container mx-auto px-4">
                    <div class="text-center mb-16 reveal">
                        <h2 class="text-4xl md:text-5xl font-bold montserrat-heading">Наша <span class="gradient-text">Команда</span></h2>
                        <p class="mt-4 text-lg text-slate-400 max-w-xl mx-auto">Три товарища, одна цель: покорить горизонт.</p>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-8 lg:gap-12">
                        <div class="glassmorphism-card p-8 text-center reveal">
                            <img src="https://placehold.co/150x150/0a0a0a/c084fc?text=Ю" alt="Фото Юры" class="w-32 h-32 rounded-full mx-auto mb-6 border-4 border-purple-500/50 shadow-lg">
                            <h3 class="text-2xl font-bold text-white">Юра "Скорость"</h3>
                            <p class="mt-2 text-purple-300 font-medium">Главный по скорости</p>
                            <p class="mt-4 text-slate-400">Первым приезжает на все остановки и с удивлением спрашивает: "А где все остальные?"</p>
                        </div>
                        <div class="glassmorphism-card p-8 text-center reveal" style="transition-delay: 0.2s;">
                            <img src="https://placehold.co/150x150/0a0a0a/818cf8?text=С" alt="Фото Сергея" class="w-32 h-32 rounded-full mx-auto mb-6 border-4 border-indigo-500/50 shadow-lg">
                            <h3 class="text-2xl font-bold text-white">Сергей "Повелитель насоса"</h3>
                            <p class="mt-2 text-indigo-300 font-medium">Технический гуру</p>
                            <p class="mt-4 text-slate-400">Знает всё о давлении в шинах. Также известен как "тайная лошадка" группы.</p>
                        </div>
                        <div class="glassmorphism-card p-8 text-center reveal" style="transition-delay: 0.4s;">
                            <img src="https://placehold.co/150x150/0a0a0a/38bdf8?text=Б" alt="Фото Богдана" class="w-32 h-32 rounded-full mx-auto mb-6 border-4 border-sky-500/50 shadow-lg">
                            <h3 class="text-2xl font-bold text-white">Богдан "Хозяин базы"</h3>
                            <p class="mt-2 text-sky-300 font-medium">Главный по гостеприимству</p>
                            <p class="mt-4 text-slate-400">Держит базу в Арнеево и встречает друзей шашлыками, сауной и пивом.</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Секция: Маршрут -->
            <section id="route" class="py-20 sm:py-32 bg-slate-900/50">
                <div class="container mx-auto px-4">
                    <div class="text-center mb-16 reveal">
                        <h2 class="text-4xl md:text-5xl font-bold montserrat-heading">Интерактивная карта <span class="gradient-text">Маршрута</span></h2>
                        <p class="mt-4 text-lg text-slate-400 max-w-xl mx-auto">42 км велосипедного приключения вдоль берегов Оки. Взаимодействуйте с картой!</p>
                    </div>
                    
                    <!-- Статистика маршрута -->
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8 reveal">
                        <div class="glassmorphism-card text-center p-4">
                            <div class="text-slate-400 text-sm mb-2">Расстояние</div>
                            <div id="distance-stat" class="stat-counter gradient-text">0</div>
                            <div class="text-slate-400 text-xs">км</div>
                        </div>
                        <div class="glassmorphism-card text-center p-4">
                            <div class="text-slate-400 text-sm mb-2">Общий подъём</div>
                            <div id="elevation-gain-stat" class="stat-counter gradient-text">0</div>
                            <div class="text-slate-400 text-xs">м</div>
                        </div>
                        <div class="glassmorphism-card text-center p-4">
                            <div class="text-slate-400 text-sm mb-2">Макс. высота</div>
                            <div id="max-elevation-stat" class="stat-counter gradient-text">0</div>
                            <div class="text-slate-400 text-xs">м</div>
                        </div>
                        <div class="glassmorphism-card text-center p-4">
                            <div class="text-slate-400 text-sm mb-2">Время в пути</div>
                            <div id="time-stat" class="stat-counter gradient-text">2:50</div>
                            <div class="text-slate-400 text-xs">часов</div>
                        </div>
                    </div>
                    
                    <!-- Canvas карта -->
                    <div class="glassmorphism-card p-6 mb-8 reveal">
                        <div class="relative">
                            <canvas id="mapCanvas" width="800" height="600"></canvas>
                        </div>
                        <div class="mt-4 flex flex-wrap gap-2 justify-center">
                            <button id="zoom-in" class="px-4 py-2 bg-sky-500 text-white rounded-lg hover:bg-sky-600 transition-colors flex items-center gap-2">
                                <span>➕</span> Увеличить
                            </button>
                            <button id="zoom-out" class="px-4 py-2 bg-sky-500 text-white rounded-lg hover:bg-sky-600 transition-colors flex items-center gap-2">
                                <span>➖</span> Уменьшить
                            </button>
                            <button id="center-map" class="px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors flex items-center gap-2">
                                <span>🎯</span> По центру
                            </button>
                            <button id="toggle-style" class="px-4 py-2 bg-indigo-500 text-white rounded-lg hover:bg-indigo-600 transition-colors flex items-center gap-2">
                                <span>🌙</span> Тёмная
                            </button>
                            <button id="toggle-satellite" class="px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-colors flex items-center gap-2">
                                <span>🛰️</span> Спутник
                            </button>
                            <select id="satellite-provider" class="px-3 py-2 bg-gray-700 text-white rounded-lg border border-gray-600 focus:border-orange-500 transition-colors">
                                <option value="satellite">Google Спутник</option>
                                <option value="hybrid">Google Гибрид</option>
                                <option value="eox">EOX Спутник</option>
                                <option value="maxar">Maxar (30см)</option>
                                <option value="sentinel">Sentinel-2 (10м)</option>
                            </select>
                            <button id="animate-route" class="px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 transition-colors flex items-center gap-2">
                                <span>▶</span> Анимация
                            </button>
                            <button id="download-map" class="px-4 py-2 bg-pink-500 text-white rounded-lg hover:bg-pink-600 transition-colors flex items-center gap-2">
                                <span>💾</span> Скачать
                            </button>
                        </div>
                        <p class="mt-3 text-sm text-slate-400 text-center">
                            💡 Перетаскивайте карту мышью или пальцем. Масштабируйте колесиком мыши или пинчем на сенсорных экранах.<br>
                            🎯 Кликните на пронумерованные точки для получения подробной информации о местах.
                        </p>
                    </div>
                    
                    <!-- График высот -->
                    <div class="glassmorphism-card p-6 mb-8 reveal">
                        <h3 class="text-2xl font-bold mb-4 gradient-text">Профиль высот</h3>
                        <div style="height: 200px; position: relative;">
                            <canvas id="elevationChart"></canvas>
                        </div>
                    </div>
                    
                    <!-- Ключевые точки маршрута -->
                    <div class="glassmorphism-card p-6 reveal">
                        <h3 class="text-2xl font-bold mb-4 gradient-text">Ключевые точки маршрута</h3>
                        <div id="waypoints-list" class="space-y-2"></div>
                    </div>
                </div>
            </section>

            <!-- РАЗДЕЛ: Ключевые точки -->
            <section id="pois" class="py-20 sm:py-32">
                <div class="container mx-auto px-4">
                    <div class="text-center mb-16 reveal">
                        <h2 class="text-4xl md:text-5xl font-bold montserrat-heading">Ключевые <span class="gradient-text">Точки</span></h2>
                        <p class="mt-4 text-lg text-slate-400 max-w-xl mx-auto">Места, которые нельзя пропустить.</p>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                        <div class="reveal group relative overflow-hidden rounded-2xl">
                            <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/91/Pushino_Oka_Manor.jpg/500px-Pushino_Oka_Manor.jpg" alt="Усадьба Пущино" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110">
                            <div class="absolute inset-0 bg-gradient-to-t from-black/80 to-transparent"></div>
                            <div class="absolute bottom-0 left-0 p-8">
                                <h3 class="text-3xl font-bold text-white">Усадьба Пущино</h3>
                                <p class="text-slate-300 mt-2">Прикосновение к истории в тени старинного парка.</p>
                            </div>
                        </div>
                        <div class="reveal group relative overflow-hidden rounded-2xl" style="transition-delay: 0.2s;">
                            <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQA4xIWHuUdjTFyf9n12y8exKwQpSuN_xu0tw&s" alt="Пущинский водопад" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110">
                            <div class="absolute inset-0 bg-gradient-to-t from-black/80 to-transparent"></div>
                            <div class="absolute bottom-0 left-0 p-8">
                                <h3 class="text-3xl font-bold text-white">Пущинский водопад</h3>
                                <p class="text-slate-300 mt-2">Оазис прохлады и звуков падающей воды.</p>
                            </div>
                        </div>
                        <div class="reveal group relative overflow-hidden rounded-2xl" style="transition-delay: 0.4s;">
                            <img src="https://media.kupo.la/thumbor/unsafe/preset/orig/images/2018/9/11/1536655687-YcGRPwpMMsA.jpg" alt="Смотровая площадка" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110">
                            <div class="absolute inset-0 bg-gradient-to-t from-black/80 to-transparent"></div>
                            <div class="absolute bottom-0 left-0 p-8">
                                <h3 class="text-3xl font-bold text-white">Смотровая площадка</h3>
                                <p class="text-slate-300 mt-2">Панорамный вид на Оку, от которого захватывает дух.</p>
                            </div>
                        </div>
                        <div class="reveal group relative overflow-hidden rounded-2xl" style="transition-delay: 0.6s;">
                            <img src="https://dynamic-media-cdn.tripadvisor.com/media/photo-o/11/8d/6c/79/caption.jpg?w=1200&h=1200&s=1" alt="Пляж в Пущино" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110">
                            <div class="absolute inset-0 bg-gradient-to-t from-black/80 to-transparent"></div>
                            <div class="absolute bottom-0 left-0 p-8">
                                <h3 class="text-3xl font-bold text-white">Пляж и пристань</h3>
                                <p class="text-slate-300 mt-2">Идеальное место для отдыха у воды перед обратной дорогой.</p>
                            </div>
                        </div>
                        <div class="reveal group relative overflow-hidden rounded-2xl lg:col-span-2" style="transition-delay: 0.8s;">
                            <img src="https://imgur.com/7Rp4Thb.jpg" alt="Афтепати в Арнеево" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110">
                            <div class="absolute inset-0 bg-gradient-to-t from-black/80 to-transparent"></div>
                            <div class="absolute bottom-0 left-0 p-8">
                                <h3 class="text-3xl font-bold text-white">Дом Богдана: Афтепати</h3>
                                <p class="text-slate-300 mt-2">Заслуженный отдых: шашлыки, сауна и ледяное пиво!</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- НОВЫЙ РАЗДЕЛ: Подготовка к поездке -->
            <section id="preparation" class="py-20 sm:py-32 bg-slate-900/50">
                <div class="container mx-auto px-4 text-center">
                    <div class="mb-16 reveal">
                        <h2 class="text-4xl md:text-5xl font-bold montserrat-heading">Готовимся к <span class="gradient-text">Поездке</span></h2>
                        <p class="mt-4 text-lg text-slate-400 max-w-xl mx-auto">Не уверены, что взять с собой? Используйте наш умный помощник для подготовки!</p>
                    </div>
                    <div class="reveal">
                        <button id="generate-gear-btn" class="gemini-button text-white font-bold py-3 px-8 rounded-full text-lg transform hover:scale-105 shadow-lg shadow-purple-500/20 flex items-center gap-2 mx-auto">
                            <i data-lucide="list-checks"></i>
                            Сгенерировать список снаряжения
                        </button>
                    </div>
                </div>
            </section>

            <!-- Секция: Галерея -->
            <section id="gallery" class="py-20 sm:py-32">
                <div class="container mx-auto px-4">
                    <div class="text-center mb-16 reveal">
                        <h2 class="text-4xl md:text-5xl font-bold montserrat-heading">Дух <span class="gradient-text">Путешествия</span></h2>
                        <p class="mt-4 text-lg text-slate-400 max-w-xl mx-auto">Классические шедевры русской живописи, вдохновляющие на путешествия по родной природе.</p>
                    </div>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                        <div class="grid gap-4">
                            <div class="reveal"><img class="h-auto max-w-full rounded-lg transition-transform duration-300 hover:scale-105" src="https://assets.wikiwand.com/_next/image?url=https://upload.wikimedia.org/wikipedia/commons/thumb/f/fa/Vladimirka_without_frame.jpg/1100px-Vladimirka_without_frame.jpg&w=828&q=70"></div>
                            <div class="reveal"><img class="h-auto max-w-full rounded-lg transition-transform duration-300 hover:scale-105" src="https://i.imgur.com/lGoVbuW.png" alt="Утро в сосновом лесу - Иван Шишкин"></div>
                        </div>
                        <div class="grid gap-4">
                            <div class="reveal"><img class="h-auto max-w-full rounded-lg transition-transform duration-300 hover:scale-105" src="https://assets.wikiwand.com/_next/image?url=https://upload.wikimedia.org/wikipedia/commons/thumb/9/95/Levitan_nad_vech_pok28.jpg/1100px-Levitan_nad_vech_pok28.jpg&w=828&q=70" alt="Над вечным покоем"></div>
                            <div class="reveal"><img class="h-auto max-w-full rounded-lg transition-transform duration-300 hover:scale-105" src="https://assets.wikiwand.com/_next/image?url=https://upload.wikimedia.org/wikipedia/commons/thumb/5/57/Levitan_Zolotaya_Osen.jpg/1100px-Levitan_Zolotaya_Osen.jpg&w=828&q=70" alt="Золотая осень. Слободка - Исаак Левитан"></div>
                        </div>
                        <div class="grid gap-4">
                            <div class="reveal"><img class="h-auto max-w-full rounded-lg transition-transform duration-300 hover:scale-105" src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/96/Klimt_-_Unterach_at_the_Altersee%2C_1916.jpg/1026px-Klimt_-_Unterach_at_the_Altersee%2C_1916.jpg" alt="Унтерах на Аттерзе"></div>
                            <div class="reveal"><img class="h-auto max-w-full rounded-lg transition-transform duration-300 hover:scale-105" src="https://cdn.tretyakov.ru/mytretyakov/25/7891912e16d8f6eefddfd0b9de5408a3/thumb/c9a14671cc45ace3df2b2400830bcbf1_x1.png" alt="Сосновый бор - Иван Шишкин"></div>
                        </div>
                        <div class="grid gap-4">
                            <div class="reveal"><img class="h-auto max-w-full rounded-lg transition-transform duration-300 hover:scale-105" src="https://assets.wikiwand.com/_next/image?url=https://upload.wikimedia.org/wikipedia/commons/thumb/c/ce/Moscow_Courtyard_%2528Polenov%252C_1878%2529_-_Google_Art_Project.jpg/1100px-Moscow_Courtyard_%2528Polenov%252C_1878%2529_-_Google_Art_Project.jpg&w=828&q=70" alt="Московский дворик - Василий Поленов"></div>
                            <div class="reveal"><img class="h-auto max-w-full rounded-lg transition-transform duration-300 hover:scale-105" src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/9c/Levitan_High_water.jpg/500px-Levitan_High_water.jpg" alt="Весна. Большая вода - Исаак Левитан"></div>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Футер -->
        <footer class="py-12 bg-black/50">
            <div class="container mx-auto px-4 text-center text-slate-400">
                 <div class="mb-8">
                    <button id="generate-report-btn" class="gemini-button text-white font-bold py-3 px-8 rounded-full text-lg transform hover:scale-105 shadow-lg shadow-purple-500/20 flex items-center gap-2 mx-auto">
                        ✨ Создать отчет о поездке
                    </button>
                </div>
                <p class="montserrat-heading text-lg font-bold gradient-text">Ока-Тур 2025</p>
                <p class="mt-2">Создано с любовью к приключениям и коду.</p>

                
                <div class="flex justify-center gap-6 mt-6">
                    <a href="#" class="hover:text-white transition-colors"><i data-lucide="instagram"></i></a>
                    <a href="#" class="hover:text-white transition-colors"><i data-lucide="send"></i></a>
                    <a href="#" class="hover:text-white transition-colors"><i data-lucide="youtube"></i></a>
                </div>
            </div>
        </footer>
    </div>

    <!-- Модальное окно для точек маршрута -->
    <div id="route-modal" class="modal-overlay">
        <div class="modal-content relative">
            <button id="close-modal" class="absolute top-4 right-4 text-slate-400 hover:text-white transition-colors z-10">
                <i data-lucide="x" class="w-8 h-8"></i>
            </button>
            <img id="modal-img" src="" alt="Фото локации" class="w-full h-64 object-cover rounded-lg mb-6">
            <h3 id="modal-title" class="text-3xl font-bold montserrat-heading gradient-text mb-2"></h3>
            <p id="modal-description" class="text-slate-300 mb-6"></p>

            <!-- Gemini Feature: Storyteller -->
            <div id="gemini-story-container">
                <button id="generate-story-btn" class="gemini-button text-white font-bold py-2 px-6 rounded-full text-base flex items-center gap-2 w-full justify-center">
                    ✨ Рассказать историю этого места
                </button>
                <div id="story-loader" class="hidden loader"></div>
                <div id="story-output" class="mt-4 text-slate-300 bg-slate-800/50 p-4 rounded-lg whitespace-pre-wrap"></div>
            </div>
        </div>
    </div>
    
    <!-- Модальное окно для отчета о поездке -->
    <div id="report-modal" class="modal-overlay">
        <div class="modal-content relative">
            <button id="close-report-modal" class="absolute top-4 right-4 text-slate-400 hover:text-white transition-colors z-10">
                <i data-lucide="x" class="w-8 h-8"></i>
            </button>
            <h3 class="text-3xl font-bold montserrat-heading gradient-text mb-4">✨ Отчет о поездке</h3>
            <div id="report-loader" class="loader"></div>
            <div id="report-output" class="text-slate-300 bg-slate-800/50 p-4 rounded-lg whitespace-pre-wrap max-h-[60vh] overflow-y-auto"></div>
        </div>
    </div>
    
    <!-- Модальное окно для списка снаряжения -->
    <div id="gear-modal" class="modal-overlay">
        <div class="modal-content relative">
            <button id="close-gear-modal" class="absolute top-4 right-4 text-slate-400 hover:text-white transition-colors z-10">
                <i data-lucide="x" class="w-8 h-8"></i>
            </button>
            <h3 class="text-3xl font-bold montserrat-heading gradient-text mb-4">✨ Список снаряжения</h3>
            <div id="gear-loader" class="loader"></div>
            <div id="gear-output" class="text-slate-300 bg-slate-800/50 p-4 rounded-lg whitespace-pre-wrap max-h-[60vh] overflow-y-auto"></div>
        </div>
    </div>


    <!-- Подключение Three.js для 3D графики -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    
    <!-- Подключение карты -->
    <script src="map.js"></script>
    
    <!-- Chart.js для графиков -->
    <script>
        // Загрузка Chart.js с нескольких источников
        function loadChartJS() {
            const sources = [
                'https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.umd.js',
                'https://unpkg.com/chart.js@4.4.0/dist/chart.umd.js',
                'https://cdn.jsdelivr.net/npm/chart.js@4/dist/chart.umd.js'
            ];
            
            let currentIndex = 0;
            
            function tryNextSource() {
                if (currentIndex >= sources.length) {
                    console.log('Chart.js не удалось загрузить, будет использован canvas график');
                    return;
                }
                
                const script = document.createElement('script');
                script.src = sources[currentIndex];
                script.onload = () => console.log('Chart.js загружен успешно');
                script.onerror = () => {
                    console.log(`Не удалось загрузить Chart.js с ${sources[currentIndex]}`);
                    currentIndex++;
                    tryNextSource();
                };
                document.head.appendChild(script);
            }
            
            tryNextSource();
        }
        
        loadChartJS();
    </script>

    <script>
        // Инициализация иконок
        lucide.createIcons();

        // --- Анимация появления элементов при скролле ---
        const revealElements = document.querySelectorAll('.reveal');
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('visible');
                }
            });
        }, {
            threshold: 0.1
        });

        revealElements.forEach(el => {
            observer.observe(el);
        });

        // --- Логика модальных окон ---
        const routeModal = document.getElementById('route-modal');
        const closeRouteModalBtn = document.getElementById('close-modal');
        const mapPoints = document.querySelectorAll('.map-point');
        
        const reportModal = document.getElementById('report-modal');
        const generateReportBtn = document.getElementById('generate-report-btn');
        const closeReportModalBtn = document.getElementById('close-report-modal');
        
        const gearModal = document.getElementById('gear-modal');
        const generateGearBtn = document.getElementById('generate-gear-btn');
        const closeGearModalBtn = document.getElementById('close-gear-modal');

        const modalTitle = document.getElementById('modal-title');
        const modalDescription = document.getElementById('modal-description');
        const modalImg = document.getElementById('modal-img');
        
        // --- Gemini: Элементы для истории ---
        const generateStoryBtn = document.getElementById('generate-story-btn');
        const storyLoader = document.getElementById('story-loader');
        const storyOutput = document.getElementById('story-output');
        let currentLocatonTitle = '';

        mapPoints.forEach(point => {
            point.addEventListener('click', () => {
                currentLocatonTitle = point.dataset.title;
                modalTitle.textContent = currentLocatonTitle;
                modalDescription.textContent = point.dataset.description;
                modalImg.src = point.dataset.img;
                
                // Сброс состояния Gemini
                storyOutput.innerHTML = '';
                storyOutput.classList.add('hidden');
                generateStoryBtn.classList.remove('hidden');

                routeModal.classList.add('visible');
            });
        });

        const closeRouteModal = () => routeModal.classList.remove('visible');
        closeRouteModalBtn.addEventListener('click', closeRouteModal);
        routeModal.addEventListener('click', (e) => {
            if (e.target === routeModal) closeRouteModal();
        });
        
        const closeReportModal = () => reportModal.classList.remove('visible');
        generateReportBtn.addEventListener('click', () => {
            reportModal.classList.add('visible');
            generateTripReport();
        });
        closeReportModalBtn.addEventListener('click', closeReportModal);
        reportModal.addEventListener('click', (e) => {
            if (e.target === reportModal) closeReportModal();
        });
        
        const closeGearModal = () => gearModal.classList.remove('visible');
        generateGearBtn.addEventListener('click', () => {
            gearModal.classList.add('visible');
            generateGearList();
        });
        if(closeGearModalBtn) {
            closeGearModalBtn.addEventListener('click', closeGearModal);
        }
        gearModal.addEventListener('click', (e) => {
            if (e.target === gearModal) closeGearModal();
        });


        // --- Логика для кнопки музыки (исправленная версия) ---
        const music = document.getElementById('background-music');
        const playBtn = document.getElementById('play-music-btn');

        playBtn.addEventListener('click', async () => {
            try {
                if (music.paused) {
                    await music.play();
                    playBtn.innerHTML = '<i data-lucide="pause-circle"></i> Выключить Блюз';
                } else {
                    music.pause();
                    playBtn.innerHTML = '<i data-lucide="play-circle"></i> Включить Блюз';
                }
            } catch (err) {
                console.error('Ошибка воспроизведения аудио:', err);
            } finally {
                lucide.createIcons();
            }
        });


        // --- Gemini API ---
        const apiKey = ""; // API-ключ будет предоставлен средой выполнения
        
        /**
         * ✨ Функция для генерации истории о месте
         */
        async function generateLocationStory() {
            generateStoryBtn.classList.add('hidden');
            storyLoader.classList.remove('hidden');
            storyOutput.innerHTML = '';
            storyOutput.classList.add('hidden');

            const prompt = `Ты — велосипедист-путешественник с поэтической душой. Ты только что прибыл в место под названием "${currentLocatonTitle}" на берегу реки Ока. Напиши короткий, яркий и увлекательный художественный рассказ или стихотворение (на твой выбор) об этом месте и твоих ощущениях. Текст должен быть на русском языке.`;
            
            try {
                const payload = { contents: [{ role: "user", parts: [{ text: prompt }] }] };
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                const result = await response.json();
                
                if (result.candidates && result.candidates[0].content.parts[0].text) {
                    storyOutput.textContent = result.candidates[0].content.parts[0].text;
                } else {
                    storyOutput.textContent = 'Не удалось создать историю. Попробуйте еще раз.';
                }
            } catch (error) {
                console.error("Gemini API Error:", error);
                storyOutput.textContent = 'Произошла ошибка. Пожалуйста, проверьте консоль.';
            } finally {
                storyLoader.classList.add('hidden');
                storyOutput.classList.remove('hidden');
            }
        }
        
        generateStoryBtn.addEventListener('click', generateLocationStory);

        /**
         * ✨ Функция для генерации отчета о поездке
         */
        async function generateTripReport() {
            const reportLoader = document.getElementById('report-loader');
            const reportOutput = document.getElementById('report-output');
            
            reportLoader.classList.remove('hidden');
            reportOutput.innerHTML = '';
            
            const prompt = `Напиши короткий, восторженный пост для блога или социальной сети о велосипедной поездке трех друзей (Юра 'Скорость', Сергей 'Повелитель насоса', и Богдан 'Хозяин базы') вдоль реки Ока. Их маршрут был кольцевым: они стартовали от дома Богдана в Арнеево, посетили Костино, Усадьбу Пущино, Пущинский водопад, смотровую площадку, отдохнули на пляже в Пущино и триумфально вернулись обратно в Арнеево на базу к Богдану на шашлыки, в сауну и с пивом. Обязательно опиши эпичное завершение дня, красоту природы, дух товарищества и незабываемые впечатления. Добавь несколько подходящих эмодзи и хэштегов. Текст должен быть на русском языке.`;

            try {
                const payload = { contents: [{ role: "user", parts: [{ text: prompt }] }] };
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                const result = await response.json();

                if (result.candidates && result.candidates[0].content.parts[0].text) {
                    reportOutput.textContent = result.candidates[0].content.parts[0].text;
                } else {
                    reportOutput.textContent = 'Не удалось создать отчет. Попробуйте еще раз.';
                }
            } catch (error) {
                console.error("Gemini API Error:", error);
                reportOutput.textContent = 'Произошла ошибка. Пожалуйста, проверьте консоль.';
            } finally {
                reportLoader.classList.add('hidden');
            }
        }
        
        /**
         * ✨ Функция для генерации списка снаряжения
         */
        async function generateGearList() {
            const gearLoader = document.getElementById('gear-loader');
            const gearOutput = document.getElementById('gear-output');
            
            gearLoader.classList.remove('hidden');
            gearOutput.innerHTML = '';
            
            const prompt = `Ты — опытный велотурист. Составь подробный и хорошо структурированный список снаряжения для однодневной велосипедной поездки трех друзей по пересеченной местности (лесные тропы, поля, берег реки). Поездка включает купание в реке и заканчивается вечером с шашлыками, сауной и пивом. Раздели список на три четкие категории: 'Личное снаряжение (для каждого)', 'Общее снаряжение (на группу)' и 'Для афтепати'. Используй Markdown для форматирования (заголовки, списки). Текст должен быть на русском языке.`;

            try {
                const payload = { contents: [{ role: "user", parts: [{ text: prompt }] }] };
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                const result = await response.json();

                if (result.candidates && result.candidates[0].content.parts[0].text) {
                    // Gemini может вернуть Markdown, который нужно будет правильно отобразить.
                    // Для простоты пока просто вставляем как текст.
                    gearOutput.textContent = result.candidates[0].content.parts[0].text;
                } else {
                    gearOutput.textContent = 'Не удалось создать список. Попробуйте еще раз.';
                }
            } catch (error) {
                console.error("Gemini API Error:", error);
                gearOutput.textContent = 'Произошла ошибка. Пожалуйста, проверьте консоль.';
            } finally {
                gearLoader.classList.add('hidden');
            }
        }


        // --- 3D Анимация волн на фоне ---
        let scene, camera, renderer, wavePlane;
        let clock = new THREE.Clock();

        function initThree() {
            const container = document.getElementById('three-canvas-container');
            if (!container) return;

            scene = new THREE.Scene();
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.z = 1.5;

            renderer = new THREE.WebGLRenderer({ 
                canvas: document.getElementById('three-canvas'),
                alpha: true
            });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(window.devicePixelRatio);

            const geometry = new THREE.PlaneGeometry(10, 10, 50, 50);
            const material = new THREE.ShaderMaterial({
                uniforms: {
                    u_time: { type: 'f', value: 0.0 },
                    u_colorA: { type: 'v3', value: new THREE.Color('#0a0a0a') },
                    u_colorB: { type: 'v3', value: new THREE.Color('#0f2a4d') }
                },
                vertexShader: `
                    uniform float u_time;
                    varying vec2 vUv;
                    float noise(vec2 st) {
                        return fract(sin(dot(st.xy, vec2(12.9898,78.233))) * 43758.5453123);
                    }
                    void main() {
                        vUv = uv;
                        vec3 pos = position;
                        float noise_freq = 2.5;
                        float noise_amp = 0.15;
                        pos.z += noise(vec2(pos.x*noise_freq + u_time, pos.y*noise_freq)) * noise_amp;
                        pos.z += sin(pos.x * 2.0 + u_time * 1.5) * 0.1;
                        gl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);
                    }
                `,
                fragmentShader: `
                    uniform vec3 u_colorA;
                    uniform vec3 u_colorB;
                    varying vec2 vUv;
                    void main() {
                        gl_FragColor = vec4(mix(u_colorA, u_colorB, vUv.y * 2.0), 1.0);
                    }
                `
            });

            wavePlane = new THREE.Mesh(geometry, material);
            wavePlane.rotation.x = -Math.PI / 2.5;
            wavePlane.position.y = -1;
            scene.add(wavePlane);

            window.addEventListener('resize', onWindowResize, false);
            animate();
        }

        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        function animate() {
            requestAnimationFrame(animate);
            if(wavePlane && wavePlane.material && wavePlane.material.uniforms && wavePlane.material.uniforms.u_time) {
               wavePlane.material.uniforms.u_time.value = clock.getElapsedTime();
            }
            renderer.render(scene, camera);
        }

        initThree();
        
        // ========== ИНТЕРАКТИВНАЯ КАРТА МАРШРУТА ==========
        
        // Данные о ключевых точках с изображениями
        const pointsData = [
            {
                name: "Старт/Финиш: Арнеево",
                desc: "Дом Богдана",
                img: "https://placehold.co/600x400/1a202c/e2e8f0?text=Дом+Богдана+в+Арнеево",
                details: "Начало и конец нашего эпического приключения. Здесь нас ждут шашлыки, сауна и холодное пиво!"
            },
            {
                name: "Данки",
                desc: "Первая остановка",
                img: "https://placehold.co/600x400/1a202c/e2e8f0?text=Деревня+Данки",
                details: "Живописная деревенька, где мы делаем первый привал и проверяем состояние велосипедов."
            },
            {
                name: "Трасса М-2 Крым",
                desc: "Пересечение с федеральной трассой",
                img: "https://placehold.co/600x400/1a202c/e2e8f0?text=Трасса+М-2",
                details: "Важный ориентир нашего маршрута - пересечение с федеральной трассой М-2 'Крым'."
            },
            {
                name: "Костино",
                desc: "Лесные тропы и подъёмы",
                img: "https://placehold.co/600x400/1a202c/e2e8f0?text=Лесы+Костино",
                details: "Здесь начинаются настоящие лесные приключения с красивыми тропами и захватывающими подъёмами."
            },
            {
                name: "Пущинская усадьба",
                desc: "Историческое место",
                img: "https://upload.wikimedia.org/wikipedia/commons/thumb/9/91/Pushino_Oka_Manor.jpg/600px-Pushino_Oka_Manor.jpg",
                details: "Старинная усадьба с богатой историей, окружённая живописным парком. Идеальное место для фотосессии!"
            },
            {
                name: "Пущинский водопад",
                desc: "Природная достопримечательность",
                img: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQA4xIWHuUdjTFyf9n12y8exKwQpSuN_xu0tw&s",
                details: "Потрясающий водопад среди леса. Прохладная вода и звуки природы - что ещё нужно для отдыха?"
            },
            {
                name: "Пляж Пущино",
                desc: "Отдых у воды",
                img: "https://dynamic-media-cdn.tripadvisor.com/media/photo-o/11/8d/6c/79/caption.jpg?w=600&h=400&s=1",
                details: "Финальная точка перед возвращением домой. Купание в Оке и последний отдых перед обратной дорогой."
            }
        ];
        
        // Функция для показа модального окна с информацией о точке
        function showPointModal(pointData, index) {
            currentLocatonTitle = pointData.name;
            modalTitle.textContent = pointData.name;
            modalDescription.textContent = pointData.details;
            modalImg.src = pointData.img;
            
            // Сброс состояния Gemini
            storyOutput.innerHTML = '';
            storyOutput.classList.add('hidden');
            generateStoryBtn.classList.remove('hidden');
            
            routeModal.classList.add('visible');
        }
        
        // Инициализация карты с использованием внешнего модуля
        setTimeout(() => {
            if (typeof initInteractiveMap === 'function') {
                const mapApi = initInteractiveMap('mapCanvas', {
                    style: 'dark',
                    height: 600,
                    onPointClick: (point, index) => {
                        // Показываем информацию о точке в модальном окне
                        showPointModal(pointsData[index], index);
                    }
                });
                
                if (mapApi) {
                    // Привязка кнопок управления к API карты
                    document.getElementById('zoom-in')?.addEventListener('click', mapApi.zoomIn);
                    document.getElementById('zoom-out')?.addEventListener('click', mapApi.zoomOut);
                    document.getElementById('center-map')?.addEventListener('click', mapApi.center);
                    document.getElementById('animate-route')?.addEventListener('click', mapApi.animateRoute);
                    document.getElementById('download-map')?.addEventListener('click', mapApi.download);
                    
                    // Кнопка смены стиля
                    document.getElementById('toggle-style')?.addEventListener('click', function() {
                        const currentText = this.innerHTML;
                        if (currentText.includes('🌙')) {
                            mapApi.setStyle('light');
                            this.innerHTML = '<span>☀</span> Светлая';
                        } else if (currentText.includes('☀')) {
                            mapApi.setStyle('terrain');
                            this.innerHTML = '<span>🏔</span> Рельеф';
                        } else {
                            mapApi.setStyle('dark');
                            this.innerHTML = '<span>🌙</span> Тёмная';
                        }
                    });
                    
                    // Кнопка переключения спутникового режима
                    document.getElementById('toggle-satellite')?.addEventListener('click', function() {
                        mapApi.toggleSatellite();
                        const isEnabled = this.innerHTML.includes('🛰️');
                        if (isEnabled) {
                            this.innerHTML = '<span>🗺️</span> Обычная';
                        } else {
                            this.innerHTML = '<span>🛰️</span> Спутник';
                        }
                    });
                    
                    // Селектор провайдера спутниковых снимков
                    document.getElementById('satellite-provider')?.addEventListener('change', function() {
                        mapApi.setSatelliteProvider(this.value);
                        console.log(`Переключен провайдер спутниковых снимков на: ${this.options[this.selectedIndex].text}`);
                    });
                    
                    // Создание списка ключевых точек
                    mapApi.createWaypointsList('waypoints-list');
                    
                    // Анимация счетчиков статистики
                    const stats = mapApi.getStats();
                    
                    function animateValue(id, start, end, duration) {
                        const element = document.getElementById(id);
                        if (!element) return;
                        const range = end - start;
                        const increment = range / (duration / 16);
                        let current = start;
                        
                        const timer = setInterval(() => {
                            current += increment;
                            if ((increment > 0 && current >= end) || (increment < 0 && current <= end)) {
                                current = end;
                                clearInterval(timer);
                            }
                            element.textContent = Math.round(current * 10) / 10;
                        }, 16);
                    }
                    
                    animateValue('distance-stat', 0, stats.distance, 2000);
                    animateValue('elevation-gain-stat', 0, stats.elevationGain, 2000);
                    animateValue('max-elevation-stat', 0, stats.maxElevation, 2000);
                    
                    // График высот
                    setTimeout(() => {
                        const elevationCanvas = document.getElementById('elevationChart');
                        if (elevationCanvas && typeof Chart !== 'undefined') {
                            const elevationData = routeCoords.map((coord, index) => ({
                                x: index * (42.3 / routeCoords.length),
                                y: coord.ele
                            }));
                            
                            const ctx2 = elevationCanvas.getContext('2d');
                            new Chart(ctx2, {
                                type: 'line',
                                data: {
                                    labels: elevationData.map(d => Math.round(d.x) + ' км'),
                                    datasets: [{
                                        label: 'Высота (м)',
                                        data: elevationData.map(d => d.y),
                                        borderColor: '#38bdf8',
                                        backgroundColor: 'rgba(56, 189, 248, 0.1)',
                                        fill: true,
                                        tension: 0.4
                                    }]
                                },
                                options: {
                                    responsive: true,
                                    maintainAspectRatio: false,
                                    plugins: { legend: { display: false } },
                                    scales: {
                                        x: {
                                            grid: { color: 'rgba(255, 255, 255, 0.1)' },
                                            ticks: { color: '#94a3b8' }
                                        },
                                        y: {
                                            grid: { color: 'rgba(255, 255, 255, 0.1)' },
                                            ticks: { color: '#94a3b8' }
                                        }
                                    }
                                }
                            });
                        } else if (elevationCanvas) {
                            // Простой график на Canvas без Chart.js
                            const ctx = elevationCanvas.getContext('2d');
                            elevationCanvas.width = elevationCanvas.offsetWidth;
                            elevationCanvas.height = 200;
                            
                            const elevations = routeCoords.map(c => c.ele);
                            const minEle = Math.min(...elevations);
                            const maxEle = Math.max(...elevations);
                            const range = maxEle - minEle;
                            
                            ctx.fillStyle = '#1e293b';
                            ctx.fillRect(0, 0, elevationCanvas.width, elevationCanvas.height);
                            
                            ctx.strokeStyle = '#38bdf8';
                            ctx.lineWidth = 2;
                            ctx.beginPath();
                            
                            elevations.forEach((ele, i) => {
                                const x = (i / elevations.length) * elevationCanvas.width;
                                const y = elevationCanvas.height - ((ele - minEle) / range) * (elevationCanvas.height - 40) - 20;
                                
                                if (i === 0) {
                                    ctx.moveTo(x, y);
                                } else {
                                    ctx.lineTo(x, y);
                                }
                            });
                            ctx.stroke();
                            
                            ctx.lineTo(elevationCanvas.width, elevationCanvas.height - 20);
                            ctx.lineTo(0, elevationCanvas.height - 20);
                            ctx.closePath();
                            ctx.fillStyle = 'rgba(56, 189, 248, 0.1)';
                            ctx.fill();
                            
                            ctx.fillStyle = '#94a3b8';
                            ctx.font = '12px Arial';
                            ctx.fillText(`${Math.round(minEle)}м`, 5, elevationCanvas.height - 5);
                            ctx.fillText(`${Math.round(maxEle)}м`, 5, 20);
                            ctx.fillText('0 км', 5, elevationCanvas.height - 25);
                            ctx.fillText('42.3 км', elevationCanvas.width - 40, elevationCanvas.height - 25);
                        }
                    }, 1000);
                } else {
                    console.error('Не удалось инициализировать карту');
                }
            } else {
                console.error('Модуль карты не загружен');
            }
        }, 200);
    </script>
</body>
</html>
